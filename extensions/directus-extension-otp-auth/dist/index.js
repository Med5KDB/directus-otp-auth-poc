"use strict";var e=require("node:crypto"),t=require("buffer"),r=require("stream"),n=require("util"),s=require("crypto");function i(e,t){return t.forEach(function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach(function(r){if("default"!==r&&!(r in e)){var n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,n.get?n:{enumerable:!0,get:function(){return t[r]}})}})}),Object.freeze(e)}const a="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let o,c;var u=Object.freeze({__proto__:null,nanoid:function(t=21){var r;r=t-=0,!o||o.length<r?(o=Buffer.allocUnsafe(128*r),e.webcrypto.getRandomValues(o),c=0):c+r>o.length&&(e.webcrypto.getRandomValues(o),c=0),c+=r;let n="";for(let e=c-t;e<c;e++)n+=a[63&o[e]];return n},urlAlphabet:a}),l="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function d(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var f,p,h=1e3,m=60*h,y=60*m,v=24*y,g=7*v,_=365.25*v;function b(e,t,r,n){var s=t>=1.5*r;return Math.round(e/r)+" "+n+(s?"s":"")}!function(e){e.assertEqual=e=>e,e.assertIs=function(e){},e.assertNever=function(e){throw new Error},e.arrayToEnum=e=>{const t={};for(const r of e)t[r]=r;return t},e.getValidEnumValues=t=>{const r=e.objectKeys(t).filter(e=>"number"!=typeof t[t[e]]),n={};for(const e of r)n[e]=t[e];return e.objectValues(n)},e.objectValues=t=>e.objectKeys(t).map(function(e){return t[e]}),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{const t=[];for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t},e.find=(e,t)=>{for(const r of e)if(t(r))return r},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map(e=>"string"==typeof e?`'${e}'`:e).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t}(f||(f={})),function(e){e.mergeShapes=(e,t)=>({...e,...t})}(p||(p={}));const E=f.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),w=e=>{switch(typeof e){case"undefined":return E.undefined;case"string":return E.string;case"number":return isNaN(e)?E.nan:E.number;case"boolean":return E.boolean;case"function":return E.function;case"bigint":return E.bigint;case"symbol":return E.symbol;case"object":return Array.isArray(e)?E.array:null===e?E.null:e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch?E.promise:"undefined"!=typeof Map&&e instanceof Map?E.map:"undefined"!=typeof Set&&e instanceof Set?E.set:"undefined"!=typeof Date&&e instanceof Date?E.date:E.object;default:return E.unknown}},S=f.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class T extends Error{constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(e){return e.message},r={_errors:[]},n=e=>{for(const s of e.issues)if("invalid_union"===s.code)s.unionErrors.map(n);else if("invalid_return_type"===s.code)n(s.returnTypeError);else if("invalid_arguments"===s.code)n(s.argumentsError);else if(0===s.path.length)r._errors.push(t(s));else{let e=r,n=0;for(;n<s.path.length;){const r=s.path[n];n===s.path.length-1?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(t(s))):e[r]=e[r]||{_errors:[]},e=e[r],n++}}};return n(this),r}static assert(e){if(!(e instanceof T))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,f.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){const t={},r=[];for(const n of this.issues)n.path.length>0?(t[n.path[0]]=t[n.path[0]]||[],t[n.path[0]].push(e(n))):r.push(e(n));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}T.create=e=>new T(e);const x=(e,t)=>{let r;switch(e.code){case S.invalid_type:r=e.received===E.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case S.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,f.jsonStringifyReplacer)}`;break;case S.unrecognized_keys:r=`Unrecognized key(s) in object: ${f.joinValues(e.keys,", ")}`;break;case S.invalid_union:r="Invalid input";break;case S.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${f.joinValues(e.options)}`;break;case S.invalid_enum_value:r=`Invalid enum value. Expected ${f.joinValues(e.options)}, received '${e.received}'`;break;case S.invalid_arguments:r="Invalid function arguments";break;case S.invalid_return_type:r="Invalid function return type";break;case S.invalid_date:r="Invalid date";break;case S.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:f.assertNever(e.validation):r="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case S.too_small:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case S.too_big:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case S.custom:r="Invalid input";break;case S.invalid_intersection_types:r="Intersection results could not be merged";break;case S.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case S.not_finite:r="Number must be finite";break;default:r=t.defaultError,f.assertNever(e)}return{message:r}};let k=x;function O(){return k}const I=e=>{const{data:t,path:r,errorMaps:n,issueData:s}=e,i=[...r,...s.path||[]],a={...s,path:i};if(void 0!==s.message)return{...s,path:i,message:s.message};let o="";const c=n.filter(e=>!!e).slice().reverse();for(const e of c)o=e(a,{data:t,defaultError:o}).message;return{...s,path:i,message:o}};function $(e,t){const r=O(),n=I({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===x?void 0:x].filter(e=>!!e)});e.common.issues.push(n)}class R{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){const r=[];for(const n of t){if("aborted"===n.status)return N;"dirty"===n.status&&e.dirty(),r.push(n.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){const r=[];for(const e of t){const t=await e.key,n=await e.value;r.push({key:t,value:n})}return R.mergeObjectSync(e,r)}static mergeObjectSync(e,t){const r={};for(const n of t){const{key:t,value:s}=n;if("aborted"===t.status)return N;if("aborted"===s.status)return N;"dirty"===t.status&&e.dirty(),"dirty"===s.status&&e.dirty(),"__proto__"===t.value||void 0===s.value&&!n.alwaysSet||(r[t.value]=s.value)}return{status:e.value,value:r}}}const N=Object.freeze({status:"aborted"}),A=e=>({status:"dirty",value:e}),j=e=>({status:"valid",value:e}),P=e=>"aborted"===e.status,C=e=>"dirty"===e.status,L=e=>"valid"===e.status,Z=e=>"undefined"!=typeof Promise&&e instanceof Promise;function D(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function M(e,t,r,n,s){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?s.call(e,r):s?s.value=r:t.set(e,r),r}var U,F,B;"function"==typeof SuppressedError&&SuppressedError,function(e){e.errToObj=e=>"string"==typeof e?{message:e}:e||{},e.toString=e=>"string"==typeof e?e:null==e?void 0:e.message}(U||(U={}));class V{constructor(e,t,r,n){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const K=(e,t)=>{if(L(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new T(e.common.issues);return this._error=t,this._error}}};function G(e){if(!e)return{};const{errorMap:t,invalid_type_error:r,required_error:n,description:s}=e;if(t&&(r||n))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');if(t)return{errorMap:t,description:s};return{errorMap:(t,s)=>{var i,a;const{message:o}=e;return"invalid_enum_value"===t.code?{message:null!=o?o:s.defaultError}:void 0===s.data?{message:null!==(i=null!=o?o:n)&&void 0!==i?i:s.defaultError}:"invalid_type"!==t.code?{message:s.defaultError}:{message:null!==(a=null!=o?o:r)&&void 0!==a?a:s.defaultError}},description:s}}class z{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return w(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:w(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new R,ctx:{common:e.parent.common,data:e.data,parsedType:w(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(Z(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){var r;const n={common:{issues:[],async:null!==(r=null==t?void 0:t.async)&&void 0!==r&&r,contextualErrorMap:null==t?void 0:t.errorMap},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:w(e)},s=this._parseSync({data:e,path:n.path,parent:n});return K(n,s)}async parseAsync(e,t){const r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){const r={common:{issues:[],contextualErrorMap:null==t?void 0:t.errorMap,async:!0},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:w(e)},n=this._parse({data:e,path:r.path,parent:r}),s=await(Z(n)?n:Promise.resolve(n));return K(r,s)}refine(e,t){const r=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement((t,n)=>{const s=e(t),i=()=>n.addIssue({code:S.custom,...r(t)});return"undefined"!=typeof Promise&&s instanceof Promise?s.then(e=>!!e||(i(),!1)):!!s||(i(),!1)})}refinement(e,t){return this._refinement((r,n)=>!!e(r)||(n.addIssue("function"==typeof t?t(r,n):t),!1))}_refinement(e){return new Be({schema:this,typeName:et.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Ve.create(this,this._def)}nullable(){return Ke.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Se.create(this,this._def)}promise(){return Fe.create(this,this._def)}or(e){return ke.create([this,e],this._def)}and(e){return Re.create(this,e,this._def)}transform(e){return new Be({...G(this._def),schema:this,typeName:et.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t="function"==typeof e?e:()=>e;return new Ge({...G(this._def),innerType:this,defaultValue:t,typeName:et.ZodDefault})}brand(){return new We({typeName:et.ZodBranded,type:this,...G(this._def)})}catch(e){const t="function"==typeof e?e:()=>e;return new ze({...G(this._def),innerType:this,catchValue:t,typeName:et.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return Xe.create(this,e)}readonly(){return Je.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const q=/^c[^\s-]{8,}$/i,H=/^[0-9a-z]+$/,W=/^[0-9A-HJKMNP-TV-Z]{26}$/,X=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,J=/^[a-z0-9_-]{21}$/i,Y=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Q=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i;let ee;const te=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,re=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ne=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,se="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",ie=new RegExp(`^${se}$`);function ae(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`),t}function oe(e){return new RegExp(`^${ae(e)}$`)}function ce(e){let t=`${se}T${ae(e)}`;const r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function ue(e,t){return!("v4"!==t&&t||!te.test(e))||!("v6"!==t&&t||!re.test(e))}class le extends z{_parse(e){this._def.coerce&&(e.data=String(e.data));if(this._getType(e)!==E.string){const t=this._getOrReturnCtx(e);return $(t,{code:S.invalid_type,expected:E.string,received:t.parsedType}),N}const t=new R;let r;for(const n of this._def.checks)if("min"===n.kind)e.data.length<n.value&&(r=this._getOrReturnCtx(e,r),$(r,{code:S.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),t.dirty());else if("max"===n.kind)e.data.length>n.value&&(r=this._getOrReturnCtx(e,r),$(r,{code:S.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),t.dirty());else if("length"===n.kind){const s=e.data.length>n.value,i=e.data.length<n.value;(s||i)&&(r=this._getOrReturnCtx(e,r),s?$(r,{code:S.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}):i&&$(r,{code:S.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}),t.dirty())}else if("email"===n.kind)Q.test(e.data)||(r=this._getOrReturnCtx(e,r),$(r,{validation:"email",code:S.invalid_string,message:n.message}),t.dirty());else if("emoji"===n.kind)ee||(ee=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),ee.test(e.data)||(r=this._getOrReturnCtx(e,r),$(r,{validation:"emoji",code:S.invalid_string,message:n.message}),t.dirty());else if("uuid"===n.kind)X.test(e.data)||(r=this._getOrReturnCtx(e,r),$(r,{validation:"uuid",code:S.invalid_string,message:n.message}),t.dirty());else if("nanoid"===n.kind)J.test(e.data)||(r=this._getOrReturnCtx(e,r),$(r,{validation:"nanoid",code:S.invalid_string,message:n.message}),t.dirty());else if("cuid"===n.kind)q.test(e.data)||(r=this._getOrReturnCtx(e,r),$(r,{validation:"cuid",code:S.invalid_string,message:n.message}),t.dirty());else if("cuid2"===n.kind)H.test(e.data)||(r=this._getOrReturnCtx(e,r),$(r,{validation:"cuid2",code:S.invalid_string,message:n.message}),t.dirty());else if("ulid"===n.kind)W.test(e.data)||(r=this._getOrReturnCtx(e,r),$(r,{validation:"ulid",code:S.invalid_string,message:n.message}),t.dirty());else if("url"===n.kind)try{new URL(e.data)}catch(s){r=this._getOrReturnCtx(e,r),$(r,{validation:"url",code:S.invalid_string,message:n.message}),t.dirty()}else if("regex"===n.kind){n.regex.lastIndex=0;n.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),$(r,{validation:"regex",code:S.invalid_string,message:n.message}),t.dirty())}else if("trim"===n.kind)e.data=e.data.trim();else if("includes"===n.kind)e.data.includes(n.value,n.position)||(r=this._getOrReturnCtx(e,r),$(r,{code:S.invalid_string,validation:{includes:n.value,position:n.position},message:n.message}),t.dirty());else if("toLowerCase"===n.kind)e.data=e.data.toLowerCase();else if("toUpperCase"===n.kind)e.data=e.data.toUpperCase();else if("startsWith"===n.kind)e.data.startsWith(n.value)||(r=this._getOrReturnCtx(e,r),$(r,{code:S.invalid_string,validation:{startsWith:n.value},message:n.message}),t.dirty());else if("endsWith"===n.kind)e.data.endsWith(n.value)||(r=this._getOrReturnCtx(e,r),$(r,{code:S.invalid_string,validation:{endsWith:n.value},message:n.message}),t.dirty());else if("datetime"===n.kind){ce(n).test(e.data)||(r=this._getOrReturnCtx(e,r),$(r,{code:S.invalid_string,validation:"datetime",message:n.message}),t.dirty())}else if("date"===n.kind){ie.test(e.data)||(r=this._getOrReturnCtx(e,r),$(r,{code:S.invalid_string,validation:"date",message:n.message}),t.dirty())}else if("time"===n.kind){oe(n).test(e.data)||(r=this._getOrReturnCtx(e,r),$(r,{code:S.invalid_string,validation:"time",message:n.message}),t.dirty())}else"duration"===n.kind?Y.test(e.data)||(r=this._getOrReturnCtx(e,r),$(r,{validation:"duration",code:S.invalid_string,message:n.message}),t.dirty()):"ip"===n.kind?ue(e.data,n.version)||(r=this._getOrReturnCtx(e,r),$(r,{validation:"ip",code:S.invalid_string,message:n.message}),t.dirty()):"base64"===n.kind?ne.test(e.data)||(r=this._getOrReturnCtx(e,r),$(r,{validation:"base64",code:S.invalid_string,message:n.message}),t.dirty()):f.assertNever(n);return{status:t.value,value:e.data}}_regex(e,t,r){return this.refinement(t=>e.test(t),{validation:t,code:S.invalid_string,...U.errToObj(r)})}_addCheck(e){return new le({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...U.errToObj(e)})}url(e){return this._addCheck({kind:"url",...U.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...U.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...U.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...U.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...U.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...U.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...U.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...U.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...U.errToObj(e)})}datetime(e){var t,r;return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,offset:null!==(t=null==e?void 0:e.offset)&&void 0!==t&&t,local:null!==(r=null==e?void 0:e.local)&&void 0!==r&&r,...U.errToObj(null==e?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,...U.errToObj(null==e?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...U.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...U.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:null==t?void 0:t.position,...U.errToObj(null==t?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...U.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...U.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...U.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...U.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...U.errToObj(t)})}nonempty(e){return this.min(1,U.errToObj(e))}trim(){return new le({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new le({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new le({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>"datetime"===e.kind)}get isDate(){return!!this._def.checks.find(e=>"date"===e.kind)}get isTime(){return!!this._def.checks.find(e=>"time"===e.kind)}get isDuration(){return!!this._def.checks.find(e=>"duration"===e.kind)}get isEmail(){return!!this._def.checks.find(e=>"email"===e.kind)}get isURL(){return!!this._def.checks.find(e=>"url"===e.kind)}get isEmoji(){return!!this._def.checks.find(e=>"emoji"===e.kind)}get isUUID(){return!!this._def.checks.find(e=>"uuid"===e.kind)}get isNANOID(){return!!this._def.checks.find(e=>"nanoid"===e.kind)}get isCUID(){return!!this._def.checks.find(e=>"cuid"===e.kind)}get isCUID2(){return!!this._def.checks.find(e=>"cuid2"===e.kind)}get isULID(){return!!this._def.checks.find(e=>"ulid"===e.kind)}get isIP(){return!!this._def.checks.find(e=>"ip"===e.kind)}get isBase64(){return!!this._def.checks.find(e=>"base64"===e.kind)}get minLength(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}function de(e,t){const r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,s=r>n?r:n;return parseInt(e.toFixed(s).replace(".",""))%parseInt(t.toFixed(s).replace(".",""))/Math.pow(10,s)}le.create=e=>{var t;return new le({checks:[],typeName:et.ZodString,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...G(e)})};class fe extends z{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){this._def.coerce&&(e.data=Number(e.data));if(this._getType(e)!==E.number){const t=this._getOrReturnCtx(e);return $(t,{code:S.invalid_type,expected:E.number,received:t.parsedType}),N}let t;const r=new R;for(const n of this._def.checks)if("int"===n.kind)f.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),$(t,{code:S.invalid_type,expected:"integer",received:"float",message:n.message}),r.dirty());else if("min"===n.kind){(n.inclusive?e.data<n.value:e.data<=n.value)&&(t=this._getOrReturnCtx(e,t),$(t,{code:S.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty())}else if("max"===n.kind){(n.inclusive?e.data>n.value:e.data>=n.value)&&(t=this._getOrReturnCtx(e,t),$(t,{code:S.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty())}else"multipleOf"===n.kind?0!==de(e.data,n.value)&&(t=this._getOrReturnCtx(e,t),$(t,{code:S.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):"finite"===n.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),$(t,{code:S.not_finite,message:n.message}),r.dirty()):f.assertNever(n);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,U.toString(t))}gt(e,t){return this.setLimit("min",e,!1,U.toString(t))}lte(e,t){return this.setLimit("max",e,!0,U.toString(t))}lt(e,t){return this.setLimit("max",e,!1,U.toString(t))}setLimit(e,t,r,n){return new fe({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:U.toString(n)}]})}_addCheck(e){return new fe({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:U.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:U.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:U.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:U.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:U.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:U.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:U.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:U.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:U.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>"int"===e.kind||"multipleOf"===e.kind&&f.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const r of this._def.checks){if("finite"===r.kind||"int"===r.kind||"multipleOf"===r.kind)return!0;"min"===r.kind?(null===t||r.value>t)&&(t=r.value):"max"===r.kind&&(null===e||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}fe.create=e=>new fe({checks:[],typeName:et.ZodNumber,coerce:(null==e?void 0:e.coerce)||!1,...G(e)});class pe extends z{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){this._def.coerce&&(e.data=BigInt(e.data));if(this._getType(e)!==E.bigint){const t=this._getOrReturnCtx(e);return $(t,{code:S.invalid_type,expected:E.bigint,received:t.parsedType}),N}let t;const r=new R;for(const n of this._def.checks)if("min"===n.kind){(n.inclusive?e.data<n.value:e.data<=n.value)&&(t=this._getOrReturnCtx(e,t),$(t,{code:S.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty())}else if("max"===n.kind){(n.inclusive?e.data>n.value:e.data>=n.value)&&(t=this._getOrReturnCtx(e,t),$(t,{code:S.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty())}else"multipleOf"===n.kind?e.data%n.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),$(t,{code:S.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):f.assertNever(n);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,U.toString(t))}gt(e,t){return this.setLimit("min",e,!1,U.toString(t))}lte(e,t){return this.setLimit("max",e,!0,U.toString(t))}lt(e,t){return this.setLimit("max",e,!1,U.toString(t))}setLimit(e,t,r,n){return new pe({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:U.toString(n)}]})}_addCheck(e){return new pe({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:U.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:U.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:U.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:U.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:U.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}pe.create=e=>{var t;return new pe({checks:[],typeName:et.ZodBigInt,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...G(e)})};class he extends z{_parse(e){this._def.coerce&&(e.data=Boolean(e.data));if(this._getType(e)!==E.boolean){const t=this._getOrReturnCtx(e);return $(t,{code:S.invalid_type,expected:E.boolean,received:t.parsedType}),N}return j(e.data)}}he.create=e=>new he({typeName:et.ZodBoolean,coerce:(null==e?void 0:e.coerce)||!1,...G(e)});class me extends z{_parse(e){this._def.coerce&&(e.data=new Date(e.data));if(this._getType(e)!==E.date){const t=this._getOrReturnCtx(e);return $(t,{code:S.invalid_type,expected:E.date,received:t.parsedType}),N}if(isNaN(e.data.getTime())){return $(this._getOrReturnCtx(e),{code:S.invalid_date}),N}const t=new R;let r;for(const n of this._def.checks)"min"===n.kind?e.data.getTime()<n.value&&(r=this._getOrReturnCtx(e,r),$(r,{code:S.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),t.dirty()):"max"===n.kind?e.data.getTime()>n.value&&(r=this._getOrReturnCtx(e,r),$(r,{code:S.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),t.dirty()):f.assertNever(n);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(e){return new me({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:U.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:U.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}me.create=e=>new me({checks:[],coerce:(null==e?void 0:e.coerce)||!1,typeName:et.ZodDate,...G(e)});class ye extends z{_parse(e){if(this._getType(e)!==E.symbol){const t=this._getOrReturnCtx(e);return $(t,{code:S.invalid_type,expected:E.symbol,received:t.parsedType}),N}return j(e.data)}}ye.create=e=>new ye({typeName:et.ZodSymbol,...G(e)});class ve extends z{_parse(e){if(this._getType(e)!==E.undefined){const t=this._getOrReturnCtx(e);return $(t,{code:S.invalid_type,expected:E.undefined,received:t.parsedType}),N}return j(e.data)}}ve.create=e=>new ve({typeName:et.ZodUndefined,...G(e)});class ge extends z{_parse(e){if(this._getType(e)!==E.null){const t=this._getOrReturnCtx(e);return $(t,{code:S.invalid_type,expected:E.null,received:t.parsedType}),N}return j(e.data)}}ge.create=e=>new ge({typeName:et.ZodNull,...G(e)});class _e extends z{constructor(){super(...arguments),this._any=!0}_parse(e){return j(e.data)}}_e.create=e=>new _e({typeName:et.ZodAny,...G(e)});class be extends z{constructor(){super(...arguments),this._unknown=!0}_parse(e){return j(e.data)}}be.create=e=>new be({typeName:et.ZodUnknown,...G(e)});class Ee extends z{_parse(e){const t=this._getOrReturnCtx(e);return $(t,{code:S.invalid_type,expected:E.never,received:t.parsedType}),N}}Ee.create=e=>new Ee({typeName:et.ZodNever,...G(e)});class we extends z{_parse(e){if(this._getType(e)!==E.undefined){const t=this._getOrReturnCtx(e);return $(t,{code:S.invalid_type,expected:E.void,received:t.parsedType}),N}return j(e.data)}}we.create=e=>new we({typeName:et.ZodVoid,...G(e)});class Se extends z{_parse(e){const{ctx:t,status:r}=this._processInputParams(e),n=this._def;if(t.parsedType!==E.array)return $(t,{code:S.invalid_type,expected:E.array,received:t.parsedType}),N;if(null!==n.exactLength){const e=t.data.length>n.exactLength.value,s=t.data.length<n.exactLength.value;(e||s)&&($(t,{code:e?S.too_big:S.too_small,minimum:s?n.exactLength.value:void 0,maximum:e?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),r.dirty())}if(null!==n.minLength&&t.data.length<n.minLength.value&&($(t,{code:S.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),r.dirty()),null!==n.maxLength&&t.data.length>n.maxLength.value&&($(t,{code:S.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((e,r)=>n.type._parseAsync(new V(t,e,t.path,r)))).then(e=>R.mergeArray(r,e));const s=[...t.data].map((e,r)=>n.type._parseSync(new V(t,e,t.path,r)));return R.mergeArray(r,s)}get element(){return this._def.type}min(e,t){return new Se({...this._def,minLength:{value:e,message:U.toString(t)}})}max(e,t){return new Se({...this._def,maxLength:{value:e,message:U.toString(t)}})}length(e,t){return new Se({...this._def,exactLength:{value:e,message:U.toString(t)}})}nonempty(e){return this.min(1,e)}}function Te(e){if(e instanceof xe){const t={};for(const r in e.shape){const n=e.shape[r];t[r]=Ve.create(Te(n))}return new xe({...e._def,shape:()=>t})}return e instanceof Se?new Se({...e._def,type:Te(e.element)}):e instanceof Ve?Ve.create(Te(e.unwrap())):e instanceof Ke?Ke.create(Te(e.unwrap())):e instanceof Ne?Ne.create(e.items.map(e=>Te(e))):e}Se.create=(e,t)=>new Se({type:e,minLength:null,maxLength:null,exactLength:null,typeName:et.ZodArray,...G(t)});class xe extends z{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const e=this._def.shape(),t=f.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==E.object){const t=this._getOrReturnCtx(e);return $(t,{code:S.invalid_type,expected:E.object,received:t.parsedType}),N}const{status:t,ctx:r}=this._processInputParams(e),{shape:n,keys:s}=this._getCached(),i=[];if(!(this._def.catchall instanceof Ee&&"strip"===this._def.unknownKeys))for(const e in r.data)s.includes(e)||i.push(e);const a=[];for(const e of s){const t=n[e],s=r.data[e];a.push({key:{status:"valid",value:e},value:t._parse(new V(r,s,r.path,e)),alwaysSet:e in r.data})}if(this._def.catchall instanceof Ee){const e=this._def.unknownKeys;if("passthrough"===e)for(const e of i)a.push({key:{status:"valid",value:e},value:{status:"valid",value:r.data[e]}});else if("strict"===e)i.length>0&&($(r,{code:S.unrecognized_keys,keys:i}),t.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const e=this._def.catchall;for(const t of i){const n=r.data[t];a.push({key:{status:"valid",value:t},value:e._parse(new V(r,n,r.path,t)),alwaysSet:t in r.data})}}return r.common.async?Promise.resolve().then(async()=>{const e=[];for(const t of a){const r=await t.key,n=await t.value;e.push({key:r,value:n,alwaysSet:t.alwaysSet})}return e}).then(e=>R.mergeObjectSync(t,e)):R.mergeObjectSync(t,a)}get shape(){return this._def.shape()}strict(e){return U.errToObj,new xe({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,r)=>{var n,s,i,a;const o=null!==(i=null===(s=(n=this._def).errorMap)||void 0===s?void 0:s.call(n,t,r).message)&&void 0!==i?i:r.defaultError;return"unrecognized_keys"===t.code?{message:null!==(a=U.errToObj(e).message)&&void 0!==a?a:o}:{message:o}}}:{}})}strip(){return new xe({...this._def,unknownKeys:"strip"})}passthrough(){return new xe({...this._def,unknownKeys:"passthrough"})}extend(e){return new xe({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new xe({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:et.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new xe({...this._def,catchall:e})}pick(e){const t={};return f.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(t[r]=this.shape[r])}),new xe({...this._def,shape:()=>t})}omit(e){const t={};return f.objectKeys(this.shape).forEach(r=>{e[r]||(t[r]=this.shape[r])}),new xe({...this._def,shape:()=>t})}deepPartial(){return Te(this)}partial(e){const t={};return f.objectKeys(this.shape).forEach(r=>{const n=this.shape[r];e&&!e[r]?t[r]=n:t[r]=n.optional()}),new xe({...this._def,shape:()=>t})}required(e){const t={};return f.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])t[r]=this.shape[r];else{let e=this.shape[r];for(;e instanceof Ve;)e=e._def.innerType;t[r]=e}}),new xe({...this._def,shape:()=>t})}keyof(){return De(f.objectKeys(this.shape))}}xe.create=(e,t)=>new xe({shape:()=>e,unknownKeys:"strip",catchall:Ee.create(),typeName:et.ZodObject,...G(t)}),xe.strictCreate=(e,t)=>new xe({shape:()=>e,unknownKeys:"strict",catchall:Ee.create(),typeName:et.ZodObject,...G(t)}),xe.lazycreate=(e,t)=>new xe({shape:e,unknownKeys:"strip",catchall:Ee.create(),typeName:et.ZodObject,...G(t)});class ke extends z{_parse(e){const{ctx:t}=this._processInputParams(e),r=this._def.options;if(t.common.async)return Promise.all(r.map(async e=>{const r={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:r}),ctx:r}})).then(function(e){for(const t of e)if("valid"===t.result.status)return t.result;for(const r of e)if("dirty"===r.result.status)return t.common.issues.push(...r.ctx.common.issues),r.result;const r=e.map(e=>new T(e.ctx.common.issues));return $(t,{code:S.invalid_union,unionErrors:r}),N});{let e;const n=[];for(const s of r){const r={...t,common:{...t.common,issues:[]},parent:null},i=s._parseSync({data:t.data,path:t.path,parent:r});if("valid"===i.status)return i;"dirty"!==i.status||e||(e={result:i,ctx:r}),r.common.issues.length&&n.push(r.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;const s=n.map(e=>new T(e));return $(t,{code:S.invalid_union,unionErrors:s}),N}}get options(){return this._def.options}}ke.create=(e,t)=>new ke({options:e,typeName:et.ZodUnion,...G(t)});const Oe=e=>e instanceof Le?Oe(e.schema):e instanceof Be?Oe(e.innerType()):e instanceof Ze?[e.value]:e instanceof Me?e.options:e instanceof Ue?f.objectValues(e.enum):e instanceof Ge?Oe(e._def.innerType):e instanceof ve?[void 0]:e instanceof ge?[null]:e instanceof Ve?[void 0,...Oe(e.unwrap())]:e instanceof Ke?[null,...Oe(e.unwrap())]:e instanceof We||e instanceof Je?Oe(e.unwrap()):e instanceof ze?Oe(e._def.innerType):[];class Ie extends z{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==E.object)return $(t,{code:S.invalid_type,expected:E.object,received:t.parsedType}),N;const r=this.discriminator,n=t.data[r],s=this.optionsMap.get(n);return s?t.common.async?s._parseAsync({data:t.data,path:t.path,parent:t}):s._parseSync({data:t.data,path:t.path,parent:t}):($(t,{code:S.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),N)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){const n=new Map;for(const r of t){const t=Oe(r.shape[e]);if(!t.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const s of t){if(n.has(s))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(s)}`);n.set(s,r)}}return new Ie({typeName:et.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:n,...G(r)})}}function $e(e,t){const r=w(e),n=w(t);if(e===t)return{valid:!0,data:e};if(r===E.object&&n===E.object){const r=f.objectKeys(t),n=f.objectKeys(e).filter(e=>-1!==r.indexOf(e)),s={...e,...t};for(const r of n){const n=$e(e[r],t[r]);if(!n.valid)return{valid:!1};s[r]=n.data}return{valid:!0,data:s}}if(r===E.array&&n===E.array){if(e.length!==t.length)return{valid:!1};const r=[];for(let n=0;n<e.length;n++){const s=$e(e[n],t[n]);if(!s.valid)return{valid:!1};r.push(s.data)}return{valid:!0,data:r}}return r===E.date&&n===E.date&&+e===+t?{valid:!0,data:e}:{valid:!1}}class Re extends z{_parse(e){const{status:t,ctx:r}=this._processInputParams(e),n=(e,n)=>{if(P(e)||P(n))return N;const s=$e(e.value,n.value);return s.valid?((C(e)||C(n))&&t.dirty(),{status:t.value,value:s.data}):($(r,{code:S.invalid_intersection_types}),N)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([e,t])=>n(e,t)):n(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Re.create=(e,t,r)=>new Re({left:e,right:t,typeName:et.ZodIntersection,...G(r)});class Ne extends z{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==E.array)return $(r,{code:S.invalid_type,expected:E.array,received:r.parsedType}),N;if(r.data.length<this._def.items.length)return $(r,{code:S.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),N;!this._def.rest&&r.data.length>this._def.items.length&&($(r,{code:S.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const n=[...r.data].map((e,t)=>{const n=this._def.items[t]||this._def.rest;return n?n._parse(new V(r,e,r.path,t)):null}).filter(e=>!!e);return r.common.async?Promise.all(n).then(e=>R.mergeArray(t,e)):R.mergeArray(t,n)}get items(){return this._def.items}rest(e){return new Ne({...this._def,rest:e})}}Ne.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ne({items:e,typeName:et.ZodTuple,rest:null,...G(t)})};class Ae extends z{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==E.object)return $(r,{code:S.invalid_type,expected:E.object,received:r.parsedType}),N;const n=[],s=this._def.keyType,i=this._def.valueType;for(const e in r.data)n.push({key:s._parse(new V(r,e,r.path,e)),value:i._parse(new V(r,r.data[e],r.path,e)),alwaysSet:e in r.data});return r.common.async?R.mergeObjectAsync(t,n):R.mergeObjectSync(t,n)}get element(){return this._def.valueType}static create(e,t,r){return new Ae(t instanceof z?{keyType:e,valueType:t,typeName:et.ZodRecord,...G(r)}:{keyType:le.create(),valueType:e,typeName:et.ZodRecord,...G(t)})}}class je extends z{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==E.map)return $(r,{code:S.invalid_type,expected:E.map,received:r.parsedType}),N;const n=this._def.keyType,s=this._def.valueType,i=[...r.data.entries()].map(([e,t],i)=>({key:n._parse(new V(r,e,r.path,[i,"key"])),value:s._parse(new V(r,t,r.path,[i,"value"]))}));if(r.common.async){const e=new Map;return Promise.resolve().then(async()=>{for(const r of i){const n=await r.key,s=await r.value;if("aborted"===n.status||"aborted"===s.status)return N;"dirty"!==n.status&&"dirty"!==s.status||t.dirty(),e.set(n.value,s.value)}return{status:t.value,value:e}})}{const e=new Map;for(const r of i){const n=r.key,s=r.value;if("aborted"===n.status||"aborted"===s.status)return N;"dirty"!==n.status&&"dirty"!==s.status||t.dirty(),e.set(n.value,s.value)}return{status:t.value,value:e}}}}je.create=(e,t,r)=>new je({valueType:t,keyType:e,typeName:et.ZodMap,...G(r)});class Pe extends z{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==E.set)return $(r,{code:S.invalid_type,expected:E.set,received:r.parsedType}),N;const n=this._def;null!==n.minSize&&r.data.size<n.minSize.value&&($(r,{code:S.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),t.dirty()),null!==n.maxSize&&r.data.size>n.maxSize.value&&($(r,{code:S.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),t.dirty());const s=this._def.valueType;function i(e){const r=new Set;for(const n of e){if("aborted"===n.status)return N;"dirty"===n.status&&t.dirty(),r.add(n.value)}return{status:t.value,value:r}}const a=[...r.data.values()].map((e,t)=>s._parse(new V(r,e,r.path,t)));return r.common.async?Promise.all(a).then(e=>i(e)):i(a)}min(e,t){return new Pe({...this._def,minSize:{value:e,message:U.toString(t)}})}max(e,t){return new Pe({...this._def,maxSize:{value:e,message:U.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}Pe.create=(e,t)=>new Pe({valueType:e,minSize:null,maxSize:null,typeName:et.ZodSet,...G(t)});class Ce extends z{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==E.function)return $(t,{code:S.invalid_type,expected:E.function,received:t.parsedType}),N;function r(e,r){return I({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,O(),x].filter(e=>!!e),issueData:{code:S.invalid_arguments,argumentsError:r}})}function n(e,r){return I({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,O(),x].filter(e=>!!e),issueData:{code:S.invalid_return_type,returnTypeError:r}})}const s={errorMap:t.common.contextualErrorMap},i=t.data;if(this._def.returns instanceof Fe){const e=this;return j(async function(...t){const a=new T([]),o=await e._def.args.parseAsync(t,s).catch(e=>{throw a.addIssue(r(t,e)),a}),c=await Reflect.apply(i,this,o);return await e._def.returns._def.type.parseAsync(c,s).catch(e=>{throw a.addIssue(n(c,e)),a})})}{const e=this;return j(function(...t){const a=e._def.args.safeParse(t,s);if(!a.success)throw new T([r(t,a.error)]);const o=Reflect.apply(i,this,a.data),c=e._def.returns.safeParse(o,s);if(!c.success)throw new T([n(o,c.error)]);return c.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Ce({...this._def,args:Ne.create(e).rest(be.create())})}returns(e){return new Ce({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new Ce({args:e||Ne.create([]).rest(be.create()),returns:t||be.create(),typeName:et.ZodFunction,...G(r)})}}class Le extends z{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}Le.create=(e,t)=>new Le({getter:e,typeName:et.ZodLazy,...G(t)});class Ze extends z{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return $(t,{received:t.data,code:S.invalid_literal,expected:this._def.value}),N}return{status:"valid",value:e.data}}get value(){return this._def.value}}function De(e,t){return new Me({values:e,typeName:et.ZodEnum,...G(t)})}Ze.create=(e,t)=>new Ze({value:e,typeName:et.ZodLiteral,...G(t)});class Me extends z{constructor(){super(...arguments),F.set(this,void 0)}_parse(e){if("string"!=typeof e.data){const t=this._getOrReturnCtx(e),r=this._def.values;return $(t,{expected:f.joinValues(r),received:t.parsedType,code:S.invalid_type}),N}if(D(this,F,"f")||M(this,F,new Set(this._def.values),"f"),!D(this,F,"f").has(e.data)){const t=this._getOrReturnCtx(e),r=this._def.values;return $(t,{received:t.data,code:S.invalid_enum_value,options:r}),N}return j(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Me.create(e,{...this._def,...t})}exclude(e,t=this._def){return Me.create(this.options.filter(t=>!e.includes(t)),{...this._def,...t})}}F=new WeakMap,Me.create=De;class Ue extends z{constructor(){super(...arguments),B.set(this,void 0)}_parse(e){const t=f.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==E.string&&r.parsedType!==E.number){const e=f.objectValues(t);return $(r,{expected:f.joinValues(e),received:r.parsedType,code:S.invalid_type}),N}if(D(this,B,"f")||M(this,B,new Set(f.getValidEnumValues(this._def.values)),"f"),!D(this,B,"f").has(e.data)){const e=f.objectValues(t);return $(r,{received:r.data,code:S.invalid_enum_value,options:e}),N}return j(e.data)}get enum(){return this._def.values}}B=new WeakMap,Ue.create=(e,t)=>new Ue({values:e,typeName:et.ZodNativeEnum,...G(t)});class Fe extends z{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==E.promise&&!1===t.common.async)return $(t,{code:S.invalid_type,expected:E.promise,received:t.parsedType}),N;const r=t.parsedType===E.promise?t.data:Promise.resolve(t.data);return j(r.then(e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap})))}}Fe.create=(e,t)=>new Fe({type:e,typeName:et.ZodPromise,...G(t)});class Be extends z{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===et.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),n=this._def.effect||null,s={addIssue:e=>{$(r,e),e.fatal?t.abort():t.dirty()},get path(){return r.path}};if(s.addIssue=s.addIssue.bind(s),"preprocess"===n.type){const e=n.transform(r.data,s);if(r.common.async)return Promise.resolve(e).then(async e=>{if("aborted"===t.value)return N;const n=await this._def.schema._parseAsync({data:e,path:r.path,parent:r});return"aborted"===n.status?N:"dirty"===n.status||"dirty"===t.value?A(n.value):n});{if("aborted"===t.value)return N;const n=this._def.schema._parseSync({data:e,path:r.path,parent:r});return"aborted"===n.status?N:"dirty"===n.status||"dirty"===t.value?A(n.value):n}}if("refinement"===n.type){const e=e=>{const t=n.refinement(e,s);if(r.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===r.common.async){const n=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===n.status?N:("dirty"===n.status&&t.dirty(),e(n.value),{status:t.value,value:n.value})}return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(r=>"aborted"===r.status?N:("dirty"===r.status&&t.dirty(),e(r.value).then(()=>({status:t.value,value:r.value}))))}if("transform"===n.type){if(!1===r.common.async){const e=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!L(e))return e;const i=n.transform(e.value,s);if(i instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:i}}return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(e=>L(e)?Promise.resolve(n.transform(e.value,s)).then(e=>({status:t.value,value:e})):e)}f.assertNever(n)}}Be.create=(e,t,r)=>new Be({schema:e,typeName:et.ZodEffects,effect:t,...G(r)}),Be.createWithPreprocess=(e,t,r)=>new Be({schema:t,effect:{type:"preprocess",transform:e},typeName:et.ZodEffects,...G(r)});class Ve extends z{_parse(e){return this._getType(e)===E.undefined?j(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ve.create=(e,t)=>new Ve({innerType:e,typeName:et.ZodOptional,...G(t)});class Ke extends z{_parse(e){return this._getType(e)===E.null?j(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ke.create=(e,t)=>new Ke({innerType:e,typeName:et.ZodNullable,...G(t)});class Ge extends z{_parse(e){const{ctx:t}=this._processInputParams(e);let r=t.data;return t.parsedType===E.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Ge.create=(e,t)=>new Ge({innerType:e,typeName:et.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...G(t)});class ze extends z{_parse(e){const{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},n=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Z(n)?n.then(e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new T(r.common.issues)},input:r.data})})):{status:"valid",value:"valid"===n.status?n.value:this._def.catchValue({get error(){return new T(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}ze.create=(e,t)=>new ze({innerType:e,typeName:et.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...G(t)});class qe extends z{_parse(e){if(this._getType(e)!==E.nan){const t=this._getOrReturnCtx(e);return $(t,{code:S.invalid_type,expected:E.nan,received:t.parsedType}),N}return{status:"valid",value:e.data}}}qe.create=e=>new qe({typeName:et.ZodNaN,...G(e)});const He=Symbol("zod_brand");class We extends z{_parse(e){const{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class Xe extends z{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.common.async){return(async()=>{const e=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?N:"dirty"===e.status?(t.dirty(),A(e.value)):this._def.out._parseAsync({data:e.value,path:r.path,parent:r})})()}{const e=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?N:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:r.path,parent:r})}}static create(e,t){return new Xe({in:e,out:t,typeName:et.ZodPipeline})}}class Je extends z{_parse(e){const t=this._def.innerType._parse(e),r=e=>(L(e)&&(e.value=Object.freeze(e.value)),e);return Z(t)?t.then(e=>r(e)):r(t)}unwrap(){return this._def.innerType}}function Ye(e,t={},r){return e?_e.create().superRefine((n,s)=>{var i,a;if(!e(n)){const e="function"==typeof t?t(n):"string"==typeof t?{message:t}:t,o=null===(a=null!==(i=e.fatal)&&void 0!==i?i:r)||void 0===a||a,c="string"==typeof e?{message:e}:e;s.addIssue({code:"custom",...c,fatal:o})}}):_e.create()}Je.create=(e,t)=>new Je({innerType:e,typeName:et.ZodReadonly,...G(t)});const Qe={object:xe.lazycreate};var et;!function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(et||(et={}));const tt=le.create,rt=fe.create,nt=qe.create,st=pe.create,it=he.create,at=me.create,ot=ye.create,ct=ve.create,ut=ge.create,lt=_e.create,dt=be.create,ft=Ee.create,pt=we.create,ht=Se.create,mt=xe.create,yt=xe.strictCreate,vt=ke.create,gt=Ie.create,_t=Re.create,bt=Ne.create,Et=Ae.create,wt=je.create,St=Pe.create,Tt=Ce.create,xt=Le.create,kt=Ze.create,Ot=Me.create,It=Ue.create,$t=Fe.create,Rt=Be.create,Nt=Ve.create,At=Ke.create,jt=Be.createWithPreprocess,Pt=Xe.create,Ct={string:e=>le.create({...e,coerce:!0}),number:e=>fe.create({...e,coerce:!0}),boolean:e=>he.create({...e,coerce:!0}),bigint:e=>pe.create({...e,coerce:!0}),date:e=>me.create({...e,coerce:!0})},Lt=N;var Zt=Object.freeze({__proto__:null,defaultErrorMap:x,setErrorMap:function(e){k=e},getErrorMap:O,makeIssue:I,EMPTY_PATH:[],addIssueToContext:$,ParseStatus:R,INVALID:N,DIRTY:A,OK:j,isAborted:P,isDirty:C,isValid:L,isAsync:Z,get util(){return f},get objectUtil(){return p},ZodParsedType:E,getParsedType:w,ZodType:z,datetimeRegex:ce,ZodString:le,ZodNumber:fe,ZodBigInt:pe,ZodBoolean:he,ZodDate:me,ZodSymbol:ye,ZodUndefined:ve,ZodNull:ge,ZodAny:_e,ZodUnknown:be,ZodNever:Ee,ZodVoid:we,ZodArray:Se,ZodObject:xe,ZodUnion:ke,ZodDiscriminatedUnion:Ie,ZodIntersection:Re,ZodTuple:Ne,ZodRecord:Ae,ZodMap:je,ZodSet:Pe,ZodFunction:Ce,ZodLazy:Le,ZodLiteral:Ze,ZodEnum:Me,ZodNativeEnum:Ue,ZodPromise:Fe,ZodEffects:Be,ZodTransformer:Be,ZodOptional:Ve,ZodNullable:Ke,ZodDefault:Ge,ZodCatch:ze,ZodNaN:qe,BRAND:He,ZodBranded:We,ZodPipeline:Xe,ZodReadonly:Je,custom:Ye,Schema:z,ZodSchema:z,late:Qe,get ZodFirstPartyTypeKind(){return et},coerce:Ct,any:lt,array:ht,bigint:st,boolean:it,date:at,discriminatedUnion:gt,effect:Rt,enum:Ot,function:Tt,instanceof:(e,t={message:`Input not instance of ${e.name}`})=>Ye(t=>t instanceof e,t),intersection:_t,lazy:xt,literal:kt,map:wt,nan:nt,nativeEnum:It,never:ft,null:ut,nullable:At,number:rt,object:mt,oboolean:()=>it().optional(),onumber:()=>rt().optional(),optional:Nt,ostring:()=>tt().optional(),pipeline:Pt,preprocess:jt,promise:$t,record:Et,set:St,strictObject:yt,string:tt,symbol:ot,transformer:Rt,tuple:bt,undefined:ct,union:vt,unknown:dt,void:pt,NEVER:Lt,ZodIssueCode:S,quotelessJson:e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),ZodError:T}),Dt=["interface","display","layout","module","panel","theme"],Mt=["hook","endpoint"],Ut=["operation"],Ft="directus:extension",Bt=Zt.object({app:Zt.string(),api:Zt.string()}),Vt=Zt.object({request:Zt.optional(Zt.object({urls:Zt.array(Zt.string()),methods:Zt.array(Zt.union([Zt.literal("GET"),Zt.literal("POST"),Zt.literal("PATCH"),Zt.literal("PUT"),Zt.literal("DELETE")]))})),log:Zt.optional(Zt.object({})),sleep:Zt.optional(Zt.object({}))}),Kt=Zt.optional(Zt.object({enabled:Zt.boolean(),requestedScopes:Vt})),Gt=Zt.union([Zt.object({type:Zt.enum(Mt),name:Zt.string(),source:Zt.string()}),Zt.object({type:Zt.enum(Dt),name:Zt.string(),source:Zt.string()}),Zt.object({type:Zt.enum(Ut),name:Zt.string(),source:Bt})]),zt=Zt.object({host:Zt.string(),hidden:Zt.boolean().optional()}),qt=Zt.object({type:Zt.enum(Dt),path:Zt.string(),source:Zt.string()}),Ht=Zt.object({type:Zt.enum(Mt),path:Zt.string(),source:Zt.string(),sandbox:Kt}),Wt=Zt.object({type:Zt.enum(Ut),path:Bt,source:Bt,sandbox:Kt}),Xt=Zt.object({type:Zt.literal("bundle"),partial:Zt.boolean().optional(),path:Bt,entries:Zt.array(Gt)});Zt.array(Gt);var Jt=zt.and(Zt.union([qt,Ht,Wt,Xt]));Zt.object({name:Zt.string(),version:Zt.string(),type:Zt.union([Zt.literal("module"),Zt.literal("commonjs")]).optional(),description:Zt.string().optional(),icon:Zt.string().optional(),dependencies:Zt.record(Zt.string()).optional(),devDependencies:Zt.record(Zt.string()).optional(),[Ft]:Jt});var Yt={exports:{}};!function(e){
/**
	 * @license bcrypt.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
	 * Released under the Apache License, Version 2.0
	 * see: https://github.com/dcodeIO/bcrypt.js for details
	 */
!function(t,r){e&&e.exports?e.exports=r():(t.dcodeIO=t.dcodeIO||{}).bcrypt=r()}(l,function(){var t={},r=null;function n(t){if(e&&e.exports)try{return require("crypto").randomBytes(t)}catch(e){}try{var n;return(self.crypto||self.msCrypto).getRandomValues(n=new Uint32Array(t)),Array.prototype.slice.call(n)}catch(e){}if(!r)throw Error("Neither WebCryptoAPI nor a crypto module is available. Use bcrypt.setRandomFallback to set an alternative");return r(t)}try{n(1)}catch(e){}function s(e,t){for(var r=0,n=0,s=0,i=e.length;s<i;++s)e.charCodeAt(s)===t.charCodeAt(s)?++r:++n;return!(r<0)&&0===n}r=null,t.setRandomFallback=function(e){r=e},t.genSaltSync=function(e,t){if("number"!=typeof(e=e||p))throw Error("Illegal arguments: "+typeof e+", "+typeof t);e<4?e=4:e>31&&(e=31);var r=[];return r.push("$2a$"),e<10&&r.push("0"),r.push(e.toString()),r.push("$"),r.push(u(n(f),f)),r.join("")},t.genSalt=function(e,r,n){if("function"==typeof r&&(n=r,r=void 0),"function"==typeof e&&(n=e,e=void 0),void 0===e)e=p;else if("number"!=typeof e)throw Error("illegal arguments: "+typeof e);function s(r){i(function(){try{r(null,t.genSaltSync(e))}catch(e){r(e)}})}if(!n)return new Promise(function(e,t){s(function(r,n){r?t(r):e(n)})});if("function"!=typeof n)throw Error("Illegal callback: "+typeof n);s(n)},t.hashSync=function(e,r){if(void 0===r&&(r=p),"number"==typeof r&&(r=t.genSaltSync(r)),"string"!=typeof e||"string"!=typeof r)throw Error("Illegal arguments: "+typeof e+", "+typeof r);return S(e,r)},t.hash=function(e,r,n,s){function a(n){"string"==typeof e&&"number"==typeof r?t.genSalt(r,function(t,r){S(e,r,n,s)}):"string"==typeof e&&"string"==typeof r?S(e,r,n,s):i(n.bind(this,Error("Illegal arguments: "+typeof e+", "+typeof r)))}if(!n)return new Promise(function(e,t){a(function(r,n){r?t(r):e(n)})});if("function"!=typeof n)throw Error("Illegal callback: "+typeof n);a(n)},t.compareSync=function(e,r){if("string"!=typeof e||"string"!=typeof r)throw Error("Illegal arguments: "+typeof e+", "+typeof r);return 60===r.length&&s(t.hashSync(e,r.substr(0,r.length-31)),r)},t.compare=function(e,r,n,a){function o(n){"string"==typeof e&&"string"==typeof r?60===r.length?t.hash(e,r.substr(0,29),function(e,t){e?n(e):n(null,s(t,r))},a):i(n.bind(this,null,!1)):i(n.bind(this,Error("Illegal arguments: "+typeof e+", "+typeof r)))}if(!n)return new Promise(function(e,t){o(function(r,n){r?t(r):e(n)})});if("function"!=typeof n)throw Error("Illegal callback: "+typeof n);o(n)},t.getRounds=function(e){if("string"!=typeof e)throw Error("Illegal arguments: "+typeof e);return parseInt(e.split("$")[2],10)},t.getSalt=function(e){if("string"!=typeof e)throw Error("Illegal arguments: "+typeof e);if(60!==e.length)throw Error("Illegal hash length: "+e.length+" != 60");return e.substring(0,29)};var i="undefined"!=typeof process&&process&&"function"==typeof process.nextTick?"function"==typeof setImmediate?setImmediate:process.nextTick:setTimeout;var a="./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),o=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,54,55,56,57,58,59,60,61,62,63,-1,-1,-1,-1,-1,-1,-1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,-1,-1,-1,-1,-1,-1,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,-1,-1,-1,-1,-1],c=String.fromCharCode;function u(e,t){var r,n,s=0,i=[];if(t<=0||t>e.length)throw Error("Illegal len: "+t);for(;s<t;){if(r=255&e[s++],i.push(a[r>>2&63]),r=(3&r)<<4,s>=t){i.push(a[63&r]);break}if(r|=(n=255&e[s++])>>4&15,i.push(a[63&r]),r=(15&n)<<2,s>=t){i.push(a[63&r]);break}r|=(n=255&e[s++])>>6&3,i.push(a[63&r]),i.push(a[63&n])}return i.join("")}function l(e,t){var r,n,s,i,a,u=0,l=e.length,d=0,f=[];if(t<=0)throw Error("Illegal len: "+t);for(;u<l-1&&d<t&&(r=(a=e.charCodeAt(u++))<o.length?o[a]:-1,n=(a=e.charCodeAt(u++))<o.length?o[a]:-1,-1!=r&&-1!=n)&&(i=r<<2>>>0,i|=(48&n)>>4,f.push(c(i)),!(++d>=t||u>=l))&&-1!=(s=(a=e.charCodeAt(u++))<o.length?o[a]:-1)&&(i=(15&n)<<4>>>0,i|=(60&s)>>2,f.push(c(i)),!(++d>=t||u>=l));)i=(3&s)<<6>>>0,i|=(a=e.charCodeAt(u++))<o.length?o[a]:-1,f.push(c(i)),++d;var p=[];for(u=0;u<d;u++)p.push(f[u].charCodeAt(0));return p}var d=function(){var e={MAX_CODEPOINT:1114111,encodeUTF8:function(e,t){var r=null;for("number"==typeof e&&(r=e,e=function(){return null});null!==r||null!==(r=e());)r<128?t(127&r):r<2048?(t(r>>6&31|192),t(63&r|128)):r<65536?(t(r>>12&15|224),t(r>>6&63|128),t(63&r|128)):(t(r>>18&7|240),t(r>>12&63|128),t(r>>6&63|128),t(63&r|128)),r=null},decodeUTF8:function(e,t){for(var r,n,s,i,a=function(e){e=e.slice(0,e.indexOf(null));var t=Error(e.toString());throw t.name="TruncatedError",t.bytes=e,t};null!==(r=e());)if(128&r)if(192==(224&r))null===(n=e())&&a([r,n]),t((31&r)<<6|63&n);else if(224==(240&r))(null===(n=e())||null===(s=e()))&&a([r,n,s]),t((15&r)<<12|(63&n)<<6|63&s);else{if(240!=(248&r))throw RangeError("Illegal starting byte: "+r);(null===(n=e())||null===(s=e())||null===(i=e()))&&a([r,n,s,i]),t((7&r)<<18|(63&n)<<12|(63&s)<<6|63&i)}else t(r)},UTF16toUTF8:function(e,t){for(var r,n=null;null!==(r=null!==n?n:e());)r>=55296&&r<=57343&&null!==(n=e())&&n>=56320&&n<=57343?(t(1024*(r-55296)+n-56320+65536),n=null):t(r);null!==n&&t(n)},UTF8toUTF16:function(e,t){var r=null;for("number"==typeof e&&(r=e,e=function(){return null});null!==r||null!==(r=e());)r<=65535?t(r):(t(55296+((r-=65536)>>10)),t(r%1024+56320)),r=null},encodeUTF16toUTF8:function(t,r){e.UTF16toUTF8(t,function(t){e.encodeUTF8(t,r)})},decodeUTF8toUTF16:function(t,r){e.decodeUTF8(t,function(t){e.UTF8toUTF16(t,r)})},calculateCodePoint:function(e){return e<128?1:e<2048?2:e<65536?3:4},calculateUTF8:function(t){for(var r,n=0;null!==(r=t());)n+=e.calculateCodePoint(r);return n},calculateUTF16asUTF8:function(t){var r=0,n=0;return e.UTF16toUTF8(t,function(t){++r,n+=e.calculateCodePoint(t)}),[r,n]}};return e}();Date.now=Date.now||function(){return+new Date};var f=16,p=10,h=16,m=100,y=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],v=[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946,1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055,3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504,976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462],g=[1332899944,1700884034,1701343084,1684370003,1668446532,1869963892];function _(e,t,r,n){var s,i=e[t],a=e[t+1];return s=n[(i^=r[0])>>>24],s+=n[256|i>>16&255],s^=n[512|i>>8&255],s=n[(a^=(s+=n[768|255&i])^r[1])>>>24],s+=n[256|a>>16&255],s^=n[512|a>>8&255],s=n[(i^=(s+=n[768|255&a])^r[2])>>>24],s+=n[256|i>>16&255],s^=n[512|i>>8&255],s=n[(a^=(s+=n[768|255&i])^r[3])>>>24],s+=n[256|a>>16&255],s^=n[512|a>>8&255],s=n[(i^=(s+=n[768|255&a])^r[4])>>>24],s+=n[256|i>>16&255],s^=n[512|i>>8&255],s=n[(a^=(s+=n[768|255&i])^r[5])>>>24],s+=n[256|a>>16&255],s^=n[512|a>>8&255],s=n[(i^=(s+=n[768|255&a])^r[6])>>>24],s+=n[256|i>>16&255],s^=n[512|i>>8&255],s=n[(a^=(s+=n[768|255&i])^r[7])>>>24],s+=n[256|a>>16&255],s^=n[512|a>>8&255],s=n[(i^=(s+=n[768|255&a])^r[8])>>>24],s+=n[256|i>>16&255],s^=n[512|i>>8&255],s=n[(a^=(s+=n[768|255&i])^r[9])>>>24],s+=n[256|a>>16&255],s^=n[512|a>>8&255],s=n[(i^=(s+=n[768|255&a])^r[10])>>>24],s+=n[256|i>>16&255],s^=n[512|i>>8&255],s=n[(a^=(s+=n[768|255&i])^r[11])>>>24],s+=n[256|a>>16&255],s^=n[512|a>>8&255],s=n[(i^=(s+=n[768|255&a])^r[12])>>>24],s+=n[256|i>>16&255],s^=n[512|i>>8&255],s=n[(a^=(s+=n[768|255&i])^r[13])>>>24],s+=n[256|a>>16&255],s^=n[512|a>>8&255],s=n[(i^=(s+=n[768|255&a])^r[14])>>>24],s+=n[256|i>>16&255],s^=n[512|i>>8&255],s=n[(a^=(s+=n[768|255&i])^r[15])>>>24],s+=n[256|a>>16&255],s^=n[512|a>>8&255],i^=(s+=n[768|255&a])^r[16],e[t]=a^r[h+1],e[t+1]=i,e}function b(e,t){for(var r=0,n=0;r<4;++r)n=n<<8|255&e[t],t=(t+1)%e.length;return{key:n,offp:t}}function E(e,t,r){for(var n,s=0,i=[0,0],a=t.length,o=r.length,c=0;c<a;c++)s=(n=b(e,s)).offp,t[c]=t[c]^n.key;for(c=0;c<a;c+=2)i=_(i,0,t,r),t[c]=i[0],t[c+1]=i[1];for(c=0;c<o;c+=2)i=_(i,0,t,r),r[c]=i[0],r[c+1]=i[1]}function w(e,t,r,n,s){var a,o=g.slice(),c=o.length;if(r<4||r>31){if(a=Error("Illegal number of rounds (4-31): "+r),n)return void i(n.bind(this,a));throw a}if(t.length!==f){if(a=Error("Illegal salt length: "+t.length+" != "+f),n)return void i(n.bind(this,a));throw a}r=1<<r>>>0;var u,l,d,p=0;function h(){if(s&&s(p/r),!(p<r)){for(p=0;p<64;p++)for(d=0;d<c>>1;d++)_(o,d<<1,u,l);var a=[];for(p=0;p<c;p++)a.push((o[p]>>24&255)>>>0),a.push((o[p]>>16&255)>>>0),a.push((o[p]>>8&255)>>>0),a.push((255&o[p])>>>0);return n?void n(null,a):a}for(var f=Date.now();p<r&&(p+=1,E(e,u,l),E(t,u,l),!(Date.now()-f>m)););n&&i(h)}if(Int32Array?(u=new Int32Array(y),l=new Int32Array(v)):(u=y.slice(),l=v.slice()),function(e,t,r,n){for(var s,i=0,a=[0,0],o=r.length,c=n.length,u=0;u<o;u++)i=(s=b(t,i)).offp,r[u]=r[u]^s.key;for(i=0,u=0;u<o;u+=2)i=(s=b(e,i)).offp,a[0]^=s.key,i=(s=b(e,i)).offp,a[1]^=s.key,a=_(a,0,r,n),r[u]=a[0],r[u+1]=a[1];for(u=0;u<c;u+=2)i=(s=b(e,i)).offp,a[0]^=s.key,i=(s=b(e,i)).offp,a[1]^=s.key,a=_(a,0,r,n),n[u]=a[0],n[u+1]=a[1]}(t,e,u,l),void 0!==n)h();else for(var w;;)if(void 0!==(w=h()))return w||[]}function S(e,t,r,n){var s,a,o;if("string"!=typeof e||"string"!=typeof t){if(s=Error("Invalid string / salt: Not a string"),r)return void i(r.bind(this,s));throw s}if("$"!==t.charAt(0)||"2"!==t.charAt(1)){if(s=Error("Invalid salt version: "+t.substring(0,2)),r)return void i(r.bind(this,s));throw s}if("$"===t.charAt(2))a=String.fromCharCode(0),o=3;else{if("a"!==(a=t.charAt(2))&&"b"!==a&&"y"!==a||"$"!==t.charAt(3)){if(s=Error("Invalid salt revision: "+t.substring(2,4)),r)return void i(r.bind(this,s));throw s}o=4}if(t.charAt(o+2)>"$"){if(s=Error("Missing salt rounds"),r)return void i(r.bind(this,s));throw s}var c,p,h,m=10*parseInt(t.substring(o,o+1),10)+parseInt(t.substring(o+1,o+2),10),y=t.substring(o+3,o+25),v=(c=e+=a>="a"?"\0":"",p=[],h=0,d.encodeUTF16toUTF8(function(){return h>=c.length?null:c.charCodeAt(h++)},function(e){p.push(e)}),p),_=l(y,f);function b(e){var t=[];return t.push("$2"),a>="a"&&t.push(a),t.push("$"),m<10&&t.push("0"),t.push(m.toString()),t.push("$"),t.push(u(_,_.length)),t.push(u(e,4*g.length-1)),t.join("")}if(void 0===r)return b(w(v,_,m));w(v,_,m,function(e,t){e?r(e,null):r(null,b(t))},n)}return t.encodeBase64=u,t.decodeBase64=l,t})}(Yt);var Qt=d(Yt.exports);class er{static generateCode(){return Math.floor(1e5+9e5*Math.random()).toString()}static async hashCode(e){return await Qt.hash(e,10)}static async verifyCode(e,t){return await Qt.compare(e,t)}static getExpirationDate(e=5){return new Date(Date.now()+60*e*1e3)}static isExpired(e){return new Date>new Date(e)}}class tr{db;tableName="otp_codes";constructor(e){this.db=e}async create(e){const[t]=await this.db(this.tableName).insert({user_id:e.user_id,code:e.code,phone:e.phone,expires_at:e.expires_at,attempts:e.attempts,used:e.used,ip_address:e.ip_address||null,user_agent:e.user_agent||null,created_at:new Date}).returning("id");return t}async getLatestByPhone(e){return await this.db(this.tableName).where({phone:e}).andWhere("used",!1).orderBy("created_at","desc").first()||null}async markAsUsed(e){await this.db(this.tableName).where({id:e}).update({used:!0})}async incrementAttempts(e){const t=await this.db(this.tableName).where({id:e}).increment("attempts",1).returning("attempts");return t[0]?.attempts||0}async invalidateAllForPhone(e){await this.db(this.tableName).where({phone:e,used:!1}).update({used:!0})}async cleanupExpired(){return await this.db(this.tableName).where("expires_at","<",new Date).delete()}async tableExists(){return await this.db.schema.hasTable(this.tableName)}}class rr{fromPhone;twilioConfigured;constructor(){const e=process.env.TWILIO_ACCOUNT_SID,t=process.env.TWILIO_AUTH_TOKEN;this.fromPhone=process.env.TWILIO_PHONE_NUMBER||"",this.twilioConfigured=!!(e&&t&&this.fromPhone),this.twilioConfigured||(console.warn("  Twilio non configur - Les SMS seront affichs dans les logs"),console.warn(" Pour activer l'envoi rel de SMS, configurez: TWILIO_ACCOUNT_SID, TWILIO_AUTH_TOKEN, TWILIO_PHONE_NUMBER"))}async sendOTP(e,t){const r=`Votre code de vrification Samacoach est: ${t}\n\nCe code expire dans 5 minutes.`;return console.log("\n "),console.log("   MODE DVELOPPEMENT - SMS SIMUL"),console.log(""),console.log(` Destinataire: ${e}`),console.log(` Code OTP: ${t}`),console.log(` Message: ${r}`),console.log("  Expire dans: 5 minutes"),console.log("\n"),this.twilioConfigured&&console.log(" Configuration Twilio dtecte mais non utilise (mode POC)"),!0}isConfigured(){return this.twilioConfigured}}var nr={},sr={exports:{}};
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
!function(e,r){var n=t,s=n.Buffer;function i(e,t){for(var r in e)t[r]=e[r]}function a(e,t,r){return s(e,t,r)}s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?e.exports=n:(i(n,r),r.Buffer=a),a.prototype=Object.create(s.prototype),i(s,a),a.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return s(e,t,r)},a.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=s(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return s(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}}(sr,sr.exports);var ir=sr.exports,ar=ir.Buffer,or=r;function cr(e){if(this.buffer=null,this.writable=!0,this.readable=!0,!e)return this.buffer=ar.alloc(0),this;if("function"==typeof e.pipe)return this.buffer=ar.alloc(0),e.pipe(this),this;if(e.length||"object"==typeof e)return this.buffer=e,this.writable=!1,process.nextTick(function(){this.emit("end",e),this.readable=!1,this.emit("close")}.bind(this)),this;throw new TypeError("Unexpected data type ("+typeof e+")")}n.inherits(cr,or),cr.prototype.write=function(e){this.buffer=ar.concat([this.buffer,ar.from(e)]),this.emit("data",e)},cr.prototype.end=function(e){e&&this.write(e),this.emit("end",e),this.emit("close"),this.writable=!1,this.readable=!1};var ur=cr;function lr(e){return(e/8|0)+(e%8==0?0:1)}var dr={ES256:lr(256),ES384:lr(384),ES512:lr(521)};var fr=function(e){var t=dr[e];if(t)return t;throw new Error('Unknown algorithm "'+e+'"')},pr=ir.Buffer,hr=fr,mr=128;function yr(e){if(pr.isBuffer(e))return e;if("string"==typeof e)return pr.from(e,"base64");throw new TypeError("ECDSA signature must be a Base64 string or a Buffer")}function vr(e,t,r){for(var n=0;t+n<r&&0===e[t+n];)++n;return e[t+n]>=mr&&--n,n}var gr,_r,br={derToJose:function(e,t){e=yr(e);var r=hr(t),n=r+1,s=e.length,i=0;if(48!==e[i++])throw new Error('Could not find expected "seq"');var a=e[i++];if(129===a&&(a=e[i++]),s-i<a)throw new Error('"seq" specified length of "'+a+'", only "'+(s-i)+'" remaining');if(2!==e[i++])throw new Error('Could not find expected "int" for "r"');var o=e[i++];if(s-i-2<o)throw new Error('"r" specified length of "'+o+'", only "'+(s-i-2)+'" available');if(n<o)throw new Error('"r" specified length of "'+o+'", max of "'+n+'" is acceptable');var c=i;if(i+=o,2!==e[i++])throw new Error('Could not find expected "int" for "s"');var u=e[i++];if(s-i!==u)throw new Error('"s" specified length of "'+u+'", expected "'+(s-i)+'"');if(n<u)throw new Error('"s" specified length of "'+u+'", max of "'+n+'" is acceptable');var l=i;if((i+=u)!==s)throw new Error('Expected to consume entire buffer, but "'+(s-i)+'" bytes remain');var d=r-o,f=r-u,p=pr.allocUnsafe(d+o+f+u);for(i=0;i<d;++i)p[i]=0;e.copy(p,i,c+Math.max(-d,0),c+o);for(var h=i=r;i<h+f;++i)p[i]=0;return e.copy(p,i,l+Math.max(-f,0),l+u),p=(p=p.toString("base64")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},joseToDer:function(e,t){e=yr(e);var r=hr(t),n=e.length;if(n!==2*r)throw new TypeError('"'+t+'" signatures must be "'+2*r+'" bytes, saw "'+n+'"');var s=vr(e,0,r),i=vr(e,r,e.length),a=r-s,o=r-i,c=2+a+1+1+o,u=c<mr,l=pr.allocUnsafe((u?2:3)+c),d=0;return l[d++]=48,u?l[d++]=c:(l[d++]=129,l[d++]=255&c),l[d++]=2,l[d++]=a,s<0?(l[d++]=0,d+=e.copy(l,d,0,r)):d+=e.copy(l,d,s,r),l[d++]=2,l[d++]=o,i<0?(l[d++]=0,e.copy(l,d,r)):e.copy(l,d,r+i),l}};var Er,wr=ir.Buffer,Sr=s,Tr=br,xr=n,kr="secret must be a string or buffer",Or="key must be a string or a buffer",Ir="function"==typeof Sr.createPublicKey;function $r(e){if(!wr.isBuffer(e)&&"string"!=typeof e){if(!Ir)throw jr(Or);if("object"!=typeof e)throw jr(Or);if("string"!=typeof e.type)throw jr(Or);if("string"!=typeof e.asymmetricKeyType)throw jr(Or);if("function"!=typeof e.export)throw jr(Or)}}function Rr(e){if(!wr.isBuffer(e)&&"string"!=typeof e&&"object"!=typeof e)throw jr("key must be a string, a buffer or an object")}function Nr(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Ar(e){var t=4-(e=e.toString()).length%4;if(4!==t)for(var r=0;r<t;++r)e+="=";return e.replace(/\-/g,"+").replace(/_/g,"/")}function jr(e){var t=[].slice.call(arguments,1),r=xr.format.bind(xr,e).apply(null,t);return new TypeError(r)}function Pr(e){var t;return t=e,wr.isBuffer(t)||"string"==typeof t||(e=JSON.stringify(e)),e}function Cr(e){return function(t,r){!function(e){if(!wr.isBuffer(e)){if("string"==typeof e)return e;if(!Ir)throw jr(kr);if("object"!=typeof e)throw jr(kr);if("secret"!==e.type)throw jr(kr);if("function"!=typeof e.export)throw jr(kr)}}(r),t=Pr(t);var n=Sr.createHmac("sha"+e,r);return Nr((n.update(t),n.digest("base64")))}}Ir&&(Or+=" or a KeyObject",kr+="or a KeyObject");var Lr="timingSafeEqual"in Sr?function(e,t){return e.byteLength===t.byteLength&&Sr.timingSafeEqual(e,t)}:function(e,r){return Er||(Er=function(){if(_r)return gr;_r=1;var e=t.Buffer,r=t.SlowBuffer;function n(t,r){if(!e.isBuffer(t)||!e.isBuffer(r))return!1;if(t.length!==r.length)return!1;for(var n=0,s=0;s<t.length;s++)n|=t[s]^r[s];return 0===n}gr=n,n.install=function(){e.prototype.equal=r.prototype.equal=function(e){return n(this,e)}};var s=e.prototype.equal,i=r.prototype.equal;return n.restore=function(){e.prototype.equal=s,r.prototype.equal=i},gr}()),Er(e,r)};function Zr(e){return function(t,r,n){var s=Cr(e)(t,n);return Lr(wr.from(r),wr.from(s))}}function Dr(e){return function(t,r){Rr(r),t=Pr(t);var n=Sr.createSign("RSA-SHA"+e);return Nr((n.update(t),n.sign(r,"base64")))}}function Mr(e){return function(t,r,n){$r(n),t=Pr(t),r=Ar(r);var s=Sr.createVerify("RSA-SHA"+e);return s.update(t),s.verify(n,r,"base64")}}function Ur(e){return function(t,r){Rr(r),t=Pr(t);var n=Sr.createSign("RSA-SHA"+e);return Nr((n.update(t),n.sign({key:r,padding:Sr.constants.RSA_PKCS1_PSS_PADDING,saltLength:Sr.constants.RSA_PSS_SALTLEN_DIGEST},"base64")))}}function Fr(e){return function(t,r,n){$r(n),t=Pr(t),r=Ar(r);var s=Sr.createVerify("RSA-SHA"+e);return s.update(t),s.verify({key:n,padding:Sr.constants.RSA_PKCS1_PSS_PADDING,saltLength:Sr.constants.RSA_PSS_SALTLEN_DIGEST},r,"base64")}}function Br(e){var t=Dr(e);return function(){var r=t.apply(null,arguments);return r=Tr.derToJose(r,"ES"+e)}}function Vr(e){var t=Mr(e);return function(r,n,s){return n=Tr.joseToDer(n,"ES"+e).toString("base64"),t(r,n,s)}}function Kr(){return function(){return""}}function Gr(){return function(e,t){return""===t}}var zr=function(e){var t={hs:Cr,rs:Dr,ps:Ur,es:Br,none:Kr},r={hs:Zr,rs:Mr,ps:Fr,es:Vr,none:Gr},n=e.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/i);if(!n)throw jr('"%s" is not a valid algorithm.\n  Supported algorithms are:\n  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".',e);var s=(n[1]||n[3]).toLowerCase(),i=n[2];return{sign:t[s](i),verify:r[s](i)}},qr=t.Buffer,Hr=function(e){return"string"==typeof e?e:"number"==typeof e||qr.isBuffer(e)?e.toString():JSON.stringify(e)},Wr=ir.Buffer,Xr=ur,Jr=zr,Yr=r,Qr=Hr,en=n;function tn(e,t){return Wr.from(e,t).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function rn(e){var t=e.header,r=e.payload,n=e.secret||e.privateKey,s=e.encoding,i=Jr(t.alg),a=function(e,t,r){r=r||"utf8";var n=tn(Qr(e),"binary"),s=tn(Qr(t),r);return en.format("%s.%s",n,s)}(t,r,s),o=i.sign(a,n);return en.format("%s.%s",a,o)}function nn(e){var t=e.secret||e.privateKey||e.key,r=new Xr(t);this.readable=!0,this.header=e.header,this.encoding=e.encoding,this.secret=this.privateKey=this.key=r,this.payload=new Xr(e.payload),this.secret.once("close",function(){!this.payload.writable&&this.readable&&this.sign()}.bind(this)),this.payload.once("close",function(){!this.secret.writable&&this.readable&&this.sign()}.bind(this))}en.inherits(nn,Yr),nn.prototype.sign=function(){try{var e=rn({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",e),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},nn.sign=rn;var sn=nn,an=ir.Buffer,on=ur,cn=zr,un=r,ln=Hr,dn=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function fn(e){if(function(e){return"[object Object]"===Object.prototype.toString.call(e)}(e))return e;try{return JSON.parse(e)}catch(e){return}}function pn(e){var t=e.split(".",1)[0];return fn(an.from(t,"base64").toString("binary"))}function hn(e){return e.split(".")[2]}function mn(e){return dn.test(e)&&!!pn(e)}function yn(e,t,r){if(!t){var n=new Error("Missing algorithm parameter for jws.verify");throw n.code="MISSING_ALGORITHM",n}var s=hn(e=ln(e)),i=function(e){return e.split(".",2).join(".")}(e);return cn(t).verify(i,s,r)}function vn(e,t){if(t=t||{},!mn(e=ln(e)))return null;var r=pn(e);if(!r)return null;var n=function(e,t){t=t||"utf8";var r=e.split(".")[1];return an.from(r,"base64").toString(t)}(e);return("JWT"===r.typ||t.json)&&(n=JSON.parse(n,t.encoding)),{header:r,payload:n,signature:hn(e)}}function gn(e){var t=(e=e||{}).secret||e.publicKey||e.key,r=new on(t);this.readable=!0,this.algorithm=e.algorithm,this.encoding=e.encoding,this.secret=this.publicKey=this.key=r,this.signature=new on(e.signature),this.secret.once("close",function(){!this.signature.writable&&this.readable&&this.verify()}.bind(this)),this.signature.once("close",function(){!this.secret.writable&&this.readable&&this.verify()}.bind(this))}n.inherits(gn,un),gn.prototype.verify=function(){try{var e=yn(this.signature.buffer,this.algorithm,this.key.buffer),t=vn(this.signature.buffer,this.encoding);return this.emit("done",e,t),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},gn.decode=vn,gn.isValid=mn,gn.verify=yn;var _n=sn,bn=gn;nr.ALGORITHMS=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"],nr.sign=_n.sign,nr.verify=bn.verify,nr.decode=bn.decode,nr.isValid=bn.isValid,nr.createSign=function(e){return new _n(e)},nr.createVerify=function(e){return new bn(e)};var En=nr,wn=function(e,t){t=t||{};var r=En.decode(e,t);if(!r)return null;var n=r.payload;if("string"==typeof n)try{var s=JSON.parse(n);null!==s&&"object"==typeof s&&(n=s)}catch(e){}return!0===t.complete?{header:r.header,payload:n,signature:r.signature}:n},Sn=function(e,t){Error.call(this,e),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="JsonWebTokenError",this.message=e,t&&(this.inner=t)};(Sn.prototype=Object.create(Error.prototype)).constructor=Sn;var Tn=Sn,xn=Tn,kn=function(e,t){xn.call(this,e),this.name="NotBeforeError",this.date=t};(kn.prototype=Object.create(xn.prototype)).constructor=kn;var On=kn,In=Tn,$n=function(e,t){In.call(this,e),this.name="TokenExpiredError",this.expiredAt=t};($n.prototype=Object.create(In.prototype)).constructor=$n;var Rn=$n,Nn=function(e,t){t=t||{};var r=typeof e;if("string"===r&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var r=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return r*_;case"weeks":case"week":case"w":return r*g;case"days":case"day":case"d":return r*v;case"hours":case"hour":case"hrs":case"hr":case"h":return r*y;case"minutes":case"minute":case"mins":case"min":case"m":return r*m;case"seconds":case"second":case"secs":case"sec":case"s":return r*h;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}(e);if("number"===r&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=v)return b(e,t,v,"day");if(t>=y)return b(e,t,y,"hour");if(t>=m)return b(e,t,m,"minute");if(t>=h)return b(e,t,h,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=v)return Math.round(e/v)+"d";if(t>=y)return Math.round(e/y)+"h";if(t>=m)return Math.round(e/m)+"m";if(t>=h)return Math.round(e/h)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))},An=function(e,t){var r=t||Math.floor(Date.now()/1e3);if("string"==typeof e){var n=Nn(e);if(void 0===n)return;return Math.floor(r+n/1e3)}return"number"==typeof e?r+e:void 0},jn={exports:{}};var Pn={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2};var Cn="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};!function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:n,MAX_LENGTH:s}=Pn,i=Cn,a=(t=e.exports={}).re=[],o=t.safeRe=[],c=t.src=[],u=t.safeSrc=[],l=t.t={};let d=0;const f="[a-zA-Z0-9-]",p=[["\\s",1],["\\d",s],[f,n]],h=(e,t,r)=>{const n=(e=>{for(const[t,r]of p)e=e.split(`${t}*`).join(`${t}{0,${r}}`).split(`${t}+`).join(`${t}{1,${r}}`);return e})(t),s=d++;i(e,s,t),l[e]=s,c[s]=t,u[s]=n,a[s]=new RegExp(t,r?"g":void 0),o[s]=new RegExp(n,r?"g":void 0)};h("NUMERICIDENTIFIER","0|[1-9]\\d*"),h("NUMERICIDENTIFIERLOOSE","\\d+"),h("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${f}*`),h("MAINVERSION",`(${c[l.NUMERICIDENTIFIER]})\\.(${c[l.NUMERICIDENTIFIER]})\\.(${c[l.NUMERICIDENTIFIER]})`),h("MAINVERSIONLOOSE",`(${c[l.NUMERICIDENTIFIERLOOSE]})\\.(${c[l.NUMERICIDENTIFIERLOOSE]})\\.(${c[l.NUMERICIDENTIFIERLOOSE]})`),h("PRERELEASEIDENTIFIER",`(?:${c[l.NONNUMERICIDENTIFIER]}|${c[l.NUMERICIDENTIFIER]})`),h("PRERELEASEIDENTIFIERLOOSE",`(?:${c[l.NONNUMERICIDENTIFIER]}|${c[l.NUMERICIDENTIFIERLOOSE]})`),h("PRERELEASE",`(?:-(${c[l.PRERELEASEIDENTIFIER]}(?:\\.${c[l.PRERELEASEIDENTIFIER]})*))`),h("PRERELEASELOOSE",`(?:-?(${c[l.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${c[l.PRERELEASEIDENTIFIERLOOSE]})*))`),h("BUILDIDENTIFIER",`${f}+`),h("BUILD",`(?:\\+(${c[l.BUILDIDENTIFIER]}(?:\\.${c[l.BUILDIDENTIFIER]})*))`),h("FULLPLAIN",`v?${c[l.MAINVERSION]}${c[l.PRERELEASE]}?${c[l.BUILD]}?`),h("FULL",`^${c[l.FULLPLAIN]}$`),h("LOOSEPLAIN",`[v=\\s]*${c[l.MAINVERSIONLOOSE]}${c[l.PRERELEASELOOSE]}?${c[l.BUILD]}?`),h("LOOSE",`^${c[l.LOOSEPLAIN]}$`),h("GTLT","((?:<|>)?=?)"),h("XRANGEIDENTIFIERLOOSE",`${c[l.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),h("XRANGEIDENTIFIER",`${c[l.NUMERICIDENTIFIER]}|x|X|\\*`),h("XRANGEPLAIN",`[v=\\s]*(${c[l.XRANGEIDENTIFIER]})(?:\\.(${c[l.XRANGEIDENTIFIER]})(?:\\.(${c[l.XRANGEIDENTIFIER]})(?:${c[l.PRERELEASE]})?${c[l.BUILD]}?)?)?`),h("XRANGEPLAINLOOSE",`[v=\\s]*(${c[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[l.XRANGEIDENTIFIERLOOSE]})(?:${c[l.PRERELEASELOOSE]})?${c[l.BUILD]}?)?)?`),h("XRANGE",`^${c[l.GTLT]}\\s*${c[l.XRANGEPLAIN]}$`),h("XRANGELOOSE",`^${c[l.GTLT]}\\s*${c[l.XRANGEPLAINLOOSE]}$`),h("COERCEPLAIN",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?`),h("COERCE",`${c[l.COERCEPLAIN]}(?:$|[^\\d])`),h("COERCEFULL",c[l.COERCEPLAIN]+`(?:${c[l.PRERELEASE]})?`+`(?:${c[l.BUILD]})?(?:$|[^\\d])`),h("COERCERTL",c[l.COERCE],!0),h("COERCERTLFULL",c[l.COERCEFULL],!0),h("LONETILDE","(?:~>?)"),h("TILDETRIM",`(\\s*)${c[l.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",h("TILDE",`^${c[l.LONETILDE]}${c[l.XRANGEPLAIN]}$`),h("TILDELOOSE",`^${c[l.LONETILDE]}${c[l.XRANGEPLAINLOOSE]}$`),h("LONECARET","(?:\\^)"),h("CARETTRIM",`(\\s*)${c[l.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",h("CARET",`^${c[l.LONECARET]}${c[l.XRANGEPLAIN]}$`),h("CARETLOOSE",`^${c[l.LONECARET]}${c[l.XRANGEPLAINLOOSE]}$`),h("COMPARATORLOOSE",`^${c[l.GTLT]}\\s*(${c[l.LOOSEPLAIN]})$|^$`),h("COMPARATOR",`^${c[l.GTLT]}\\s*(${c[l.FULLPLAIN]})$|^$`),h("COMPARATORTRIM",`(\\s*)${c[l.GTLT]}\\s*(${c[l.LOOSEPLAIN]}|${c[l.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",h("HYPHENRANGE",`^\\s*(${c[l.XRANGEPLAIN]})\\s+-\\s+(${c[l.XRANGEPLAIN]})\\s*$`),h("HYPHENRANGELOOSE",`^\\s*(${c[l.XRANGEPLAINLOOSE]})\\s+-\\s+(${c[l.XRANGEPLAINLOOSE]})\\s*$`),h("STAR","(<|>)?=?\\s*\\*"),h("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),h("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(jn,jn.exports);var Ln=jn.exports;const Zn=Object.freeze({loose:!0}),Dn=Object.freeze({});var Mn=e=>e?"object"!=typeof e?Zn:e:Dn;const Un=/^[0-9]+$/,Fn=(e,t)=>{if("number"==typeof e&&"number"==typeof t)return e===t?0:e<t?-1:1;const r=Un.test(e),n=Un.test(t);return r&&n&&(e=+e,t=+t),e===t?0:r&&!n?-1:n&&!r?1:e<t?-1:1};var Bn={compareIdentifiers:Fn,rcompareIdentifiers:(e,t)=>Fn(t,e)};const Vn=Cn,{MAX_LENGTH:Kn,MAX_SAFE_INTEGER:Gn}=Pn,{safeRe:zn,t:qn}=Ln,Hn=Mn,{compareIdentifiers:Wn}=Bn;var Xn=class e{constructor(t,r){if(r=Hn(r),t instanceof e){if(t.loose===!!r.loose&&t.includePrerelease===!!r.includePrerelease)return t;t=t.version}else if("string"!=typeof t)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof t}".`);if(t.length>Kn)throw new TypeError(`version is longer than ${Kn} characters`);Vn("SemVer",t,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;const n=t.trim().match(r.loose?zn[qn.LOOSE]:zn[qn.FULL]);if(!n)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>Gn||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Gn||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Gn||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<Gn)return t}return e}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(Vn("SemVer.compare",this.version,this.options,t),!(t instanceof e)){if("string"==typeof t&&t===this.version)return 0;t=new e(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof e||(t=new e(t,this.options)),this.major<t.major?-1:this.major>t.major?1:this.minor<t.minor?-1:this.minor>t.minor?1:this.patch<t.patch?-1:this.patch>t.patch?1:0}comparePre(t){if(t instanceof e||(t=new e(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let r=0;do{const e=this.prerelease[r],n=t.prerelease[r];if(Vn("prerelease compare",r,e,n),void 0===e&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===e)return-1;if(e!==n)return Wn(e,n)}while(++r)}compareBuild(t){t instanceof e||(t=new e(t,this.options));let r=0;do{const e=this.build[r],n=t.build[r];if(Vn("build compare",r,e,n),void 0===e&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===e)return-1;if(e!==n)return Wn(e,n)}while(++r)}inc(e,t,r){if(e.startsWith("pre")){if(!t&&!1===r)throw new Error("invalid increment argument: identifier is empty");if(t){const e=`-${t}`.match(this.options.loose?zn[qn.PRERELEASELOOSE]:zn[qn.PRERELEASE]);if(!e||e[1]!==t)throw new Error(`invalid identifier: ${t}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,r),this.inc("pre",t,r);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,r),this.inc("pre",t,r);break;case"release":if(0===this.prerelease.length)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(r)?1:0;if(0===this.prerelease.length)this.prerelease=[e];else{let n=this.prerelease.length;for(;--n>=0;)"number"==typeof this.prerelease[n]&&(this.prerelease[n]++,n=-2);if(-1===n){if(t===this.prerelease.join(".")&&!1===r)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let n=[t,e];!1===r&&(n=[t]),0===Wn(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=n):this.prerelease=n}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};const Jn=Xn;var Yn=(e,t,r=!1)=>{if(e instanceof Jn)return e;try{return new Jn(e,t)}catch(e){if(!r)return null;throw e}};const Qn=Yn;var es=(e,t)=>{const r=Qn(e,t);return r?r.version:null};const ts=Yn;var rs=(e,t)=>{const r=ts(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null};const ns=Xn;var ss=(e,t,r,n,s)=>{"string"==typeof r&&(s=n,n=r,r=void 0);try{return new ns(e instanceof ns?e.version:e,r).inc(t,n,s).version}catch(e){return null}};const is=Yn;var as=(e,t)=>{const r=is(e,null,!0),n=is(t,null,!0),s=r.compare(n);if(0===s)return null;const i=s>0,a=i?r:n,o=i?n:r,c=!!a.prerelease.length;if(!!o.prerelease.length&&!c){if(!o.patch&&!o.minor)return"major";if(0===o.compareMain(a))return o.minor&&!o.patch?"minor":"patch"}const u=c?"pre":"";return r.major!==n.major?u+"major":r.minor!==n.minor?u+"minor":r.patch!==n.patch?u+"patch":"prerelease"};const os=Xn;var cs=(e,t)=>new os(e,t).major;const us=Xn;var ls=(e,t)=>new us(e,t).minor;const ds=Xn;var fs=(e,t)=>new ds(e,t).patch;const ps=Yn;var hs=(e,t)=>{const r=ps(e,t);return r&&r.prerelease.length?r.prerelease:null};const ms=Xn;var ys=(e,t,r)=>new ms(e,r).compare(new ms(t,r));const vs=ys;var gs=(e,t,r)=>vs(t,e,r);const _s=ys;var bs=(e,t)=>_s(e,t,!0);const Es=Xn;var ws=(e,t,r)=>{const n=new Es(e,r),s=new Es(t,r);return n.compare(s)||n.compareBuild(s)};const Ss=ws;var Ts=(e,t)=>e.sort((e,r)=>Ss(e,r,t));const xs=ws;var ks=(e,t)=>e.sort((e,r)=>xs(r,e,t));const Os=ys;var Is=(e,t,r)=>Os(e,t,r)>0;const $s=ys;var Rs=(e,t,r)=>$s(e,t,r)<0;const Ns=ys;var As=(e,t,r)=>0===Ns(e,t,r);const js=ys;var Ps=(e,t,r)=>0!==js(e,t,r);const Cs=ys;var Ls=(e,t,r)=>Cs(e,t,r)>=0;const Zs=ys;var Ds=(e,t,r)=>Zs(e,t,r)<=0;const Ms=As,Us=Ps,Fs=Is,Bs=Ls,Vs=Rs,Ks=Ds;var Gs=(e,t,r,n)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e===r;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e!==r;case"":case"=":case"==":return Ms(e,r,n);case"!=":return Us(e,r,n);case">":return Fs(e,r,n);case">=":return Bs(e,r,n);case"<":return Vs(e,r,n);case"<=":return Ks(e,r,n);default:throw new TypeError(`Invalid operator: ${t}`)}};const zs=Xn,qs=Yn,{safeRe:Hs,t:Ws}=Ln;var Xs=(e,t)=>{if(e instanceof zs)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let r=null;if((t=t||{}).rtl){const n=t.includePrerelease?Hs[Ws.COERCERTLFULL]:Hs[Ws.COERCERTL];let s;for(;(s=n.exec(e))&&(!r||r.index+r[0].length!==e.length);)r&&s.index+s[0].length===r.index+r[0].length||(r=s),n.lastIndex=s.index+s[1].length+s[2].length;n.lastIndex=-1}else r=e.match(t.includePrerelease?Hs[Ws.COERCEFULL]:Hs[Ws.COERCE]);if(null===r)return null;const n=r[2],s=r[3]||"0",i=r[4]||"0",a=t.includePrerelease&&r[5]?`-${r[5]}`:"",o=t.includePrerelease&&r[6]?`+${r[6]}`:"";return qs(`${n}.${s}.${i}${a}${o}`,t)};var Js,Ys,Qs,ei,ti=class{constructor(){this.max=1e3,this.map=new Map}get(e){const t=this.map.get(e);return void 0===t?void 0:(this.map.delete(e),this.map.set(e,t),t)}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&void 0!==t){if(this.map.size>=this.max){const e=this.map.keys().next().value;this.delete(e)}this.map.set(e,t)}return this}};function ri(){if(Ys)return Js;Ys=1;const e=/\s+/g;class t{constructor(r,i){if(i=n(i),r instanceof t)return r.loose===!!i.loose&&r.includePrerelease===!!i.includePrerelease?r:new t(r.raw,i);if(r instanceof s)return this.raw=r.value,this.set=[[r]],this.formatted=void 0,this;if(this.options=i,this.loose=!!i.loose,this.includePrerelease=!!i.includePrerelease,this.raw=r.trim().replace(e," "),this.set=this.raw.split("||").map(e=>this.parseRange(e.trim())).filter(e=>e.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter(e=>!h(e[0])),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&m(e[0])){this.set=[e];break}}this.formatted=void 0}get range(){if(void 0===this.formatted){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");const t=this.set[e];for(let e=0;e<t.length;e++)e>0&&(this.formatted+=" "),this.formatted+=t[e].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){const t=((this.options.includePrerelease&&f)|(this.options.loose&&p))+":"+e,n=r.get(t);if(n)return n;const a=this.options.loose,m=a?o[c.HYPHENRANGELOOSE]:o[c.HYPHENRANGE];e=e.replace(m,O(this.options.includePrerelease)),i("hyphen replace",e),e=e.replace(o[c.COMPARATORTRIM],u),i("comparator trim",e),e=e.replace(o[c.TILDETRIM],l),i("tilde trim",e),e=e.replace(o[c.CARETTRIM],d),i("caret trim",e);let y=e.split(" ").map(e=>v(e,this.options)).join(" ").split(/\s+/).map(e=>k(e,this.options));a&&(y=y.filter(e=>(i("loose invalid filter",e,this.options),!!e.match(o[c.COMPARATORLOOSE])))),i("range list",y);const g=new Map,_=y.map(e=>new s(e,this.options));for(const e of _){if(h(e))return[e];g.set(e.value,e)}g.size>1&&g.has("")&&g.delete("");const b=[...g.values()];return r.set(t,b),b}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Range is required");return this.set.some(t=>y(t,r)&&e.set.some(e=>y(e,r)&&t.every(t=>e.every(e=>t.intersects(e,r)))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new a(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(I(this.set[t],e,this.options))return!0;return!1}}Js=t;const r=new ti,n=Mn,s=ni(),i=Cn,a=Xn,{safeRe:o,t:c,comparatorTrimReplace:u,tildeTrimReplace:l,caretTrimReplace:d}=Ln,{FLAG_INCLUDE_PRERELEASE:f,FLAG_LOOSE:p}=Pn,h=e=>"<0.0.0-0"===e.value,m=e=>""===e.value,y=(e,t)=>{let r=!0;const n=e.slice();let s=n.pop();for(;r&&n.length;)r=n.every(e=>s.intersects(e,t)),s=n.pop();return r},v=(e,t)=>(e=e.replace(o[c.BUILD],""),i("comp",e,t),e=E(e,t),i("caret",e),e=_(e,t),i("tildes",e),e=S(e,t),i("xrange",e),e=x(e,t),i("stars",e),e),g=e=>!e||"x"===e.toLowerCase()||"*"===e,_=(e,t)=>e.trim().split(/\s+/).map(e=>b(e,t)).join(" "),b=(e,t)=>{const r=t.loose?o[c.TILDELOOSE]:o[c.TILDE];return e.replace(r,(t,r,n,s,a)=>{let o;return i("tilde",e,t,r,n,s,a),g(r)?o="":g(n)?o=`>=${r}.0.0 <${+r+1}.0.0-0`:g(s)?o=`>=${r}.${n}.0 <${r}.${+n+1}.0-0`:a?(i("replaceTilde pr",a),o=`>=${r}.${n}.${s}-${a} <${r}.${+n+1}.0-0`):o=`>=${r}.${n}.${s} <${r}.${+n+1}.0-0`,i("tilde return",o),o})},E=(e,t)=>e.trim().split(/\s+/).map(e=>w(e,t)).join(" "),w=(e,t)=>{i("caret",e,t);const r=t.loose?o[c.CARETLOOSE]:o[c.CARET],n=t.includePrerelease?"-0":"";return e.replace(r,(t,r,s,a,o)=>{let c;return i("caret",e,t,r,s,a,o),g(r)?c="":g(s)?c=`>=${r}.0.0${n} <${+r+1}.0.0-0`:g(a)?c="0"===r?`>=${r}.${s}.0${n} <${r}.${+s+1}.0-0`:`>=${r}.${s}.0${n} <${+r+1}.0.0-0`:o?(i("replaceCaret pr",o),c="0"===r?"0"===s?`>=${r}.${s}.${a}-${o} <${r}.${s}.${+a+1}-0`:`>=${r}.${s}.${a}-${o} <${r}.${+s+1}.0-0`:`>=${r}.${s}.${a}-${o} <${+r+1}.0.0-0`):(i("no pr"),c="0"===r?"0"===s?`>=${r}.${s}.${a}${n} <${r}.${s}.${+a+1}-0`:`>=${r}.${s}.${a}${n} <${r}.${+s+1}.0-0`:`>=${r}.${s}.${a} <${+r+1}.0.0-0`),i("caret return",c),c})},S=(e,t)=>(i("replaceXRanges",e,t),e.split(/\s+/).map(e=>T(e,t)).join(" ")),T=(e,t)=>{e=e.trim();const r=t.loose?o[c.XRANGELOOSE]:o[c.XRANGE];return e.replace(r,(r,n,s,a,o,c)=>{i("xRange",e,r,n,s,a,o,c);const u=g(s),l=u||g(a),d=l||g(o),f=d;return"="===n&&f&&(n=""),c=t.includePrerelease?"-0":"",u?r=">"===n||"<"===n?"<0.0.0-0":"*":n&&f?(l&&(a=0),o=0,">"===n?(n=">=",l?(s=+s+1,a=0,o=0):(a=+a+1,o=0)):"<="===n&&(n="<",l?s=+s+1:a=+a+1),"<"===n&&(c="-0"),r=`${n+s}.${a}.${o}${c}`):l?r=`>=${s}.0.0${c} <${+s+1}.0.0-0`:d&&(r=`>=${s}.${a}.0${c} <${s}.${+a+1}.0-0`),i("xRange return",r),r})},x=(e,t)=>(i("replaceStars",e,t),e.trim().replace(o[c.STAR],"")),k=(e,t)=>(i("replaceGTE0",e,t),e.trim().replace(o[t.includePrerelease?c.GTE0PRE:c.GTE0],"")),O=e=>(t,r,n,s,i,a,o,c,u,l,d,f)=>`${r=g(n)?"":g(s)?`>=${n}.0.0${e?"-0":""}`:g(i)?`>=${n}.${s}.0${e?"-0":""}`:a?`>=${r}`:`>=${r}${e?"-0":""}`} ${c=g(u)?"":g(l)?`<${+u+1}.0.0-0`:g(d)?`<${u}.${+l+1}.0-0`:f?`<=${u}.${l}.${d}-${f}`:e?`<${u}.${l}.${+d+1}-0`:`<=${c}`}`.trim(),I=(e,t,r)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(let r=0;r<e.length;r++)if(i(e[r].semver),e[r].semver!==s.ANY&&e[r].semver.prerelease.length>0){const n=e[r].semver;if(n.major===t.major&&n.minor===t.minor&&n.patch===t.patch)return!0}return!1}return!0};return Js}function ni(){if(ei)return Qs;ei=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(n,s){if(s=r(s),n instanceof t){if(n.loose===!!s.loose)return n;n=n.value}n=n.trim().split(/\s+/).join(" "),a("comparator",n,s),this.options=s,this.loose=!!s.loose,this.parse(n),this.semver===e?this.value="":this.value=this.operator+this.semver.version,a("comp",this)}parse(t){const r=this.options.loose?n[s.COMPARATORLOOSE]:n[s.COMPARATOR],i=t.match(r);if(!i)throw new TypeError(`Invalid comparator: ${t}`);this.operator=void 0!==i[1]?i[1]:"","="===this.operator&&(this.operator=""),i[2]?this.semver=new o(i[2],this.options.loose):this.semver=e}toString(){return this.value}test(t){if(a("Comparator.test",t,this.options.loose),this.semver===e||t===e)return!0;if("string"==typeof t)try{t=new o(t,this.options)}catch(e){return!1}return i(t,this.operator,this.semver,this.options)}intersects(e,n){if(!(e instanceof t))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new c(e.value,n).test(this.value):""===e.operator?""===e.value||new c(this.value,n).test(e.semver):(!(n=r(n)).includePrerelease||"<0.0.0-0"!==this.value&&"<0.0.0-0"!==e.value)&&(!(!n.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0")))&&(!(!this.operator.startsWith(">")||!e.operator.startsWith(">"))||(!(!this.operator.startsWith("<")||!e.operator.startsWith("<"))||(!(this.semver.version!==e.semver.version||!this.operator.includes("=")||!e.operator.includes("="))||(!!(i(this.semver,"<",e.semver,n)&&this.operator.startsWith(">")&&e.operator.startsWith("<"))||!!(i(this.semver,">",e.semver,n)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))))))}}Qs=t;const r=Mn,{safeRe:n,t:s}=Ln,i=Gs,a=Cn,o=Xn,c=ri();return Qs}const si=ri();var ii=(e,t,r)=>{try{t=new si(t,r)}catch(e){return!1}return t.test(e)};const ai=ri();var oi=(e,t)=>new ai(e,t).set.map(e=>e.map(e=>e.value).join(" ").trim().split(" "));const ci=Xn,ui=ri();var li=(e,t,r)=>{let n=null,s=null,i=null;try{i=new ui(t,r)}catch(e){return null}return e.forEach(e=>{i.test(e)&&(n&&-1!==s.compare(e)||(n=e,s=new ci(n,r)))}),n};const di=Xn,fi=ri();var pi=(e,t,r)=>{let n=null,s=null,i=null;try{i=new fi(t,r)}catch(e){return null}return e.forEach(e=>{i.test(e)&&(n&&1!==s.compare(e)||(n=e,s=new di(n,r)))}),n};const hi=Xn,mi=ri(),yi=Is;var vi=(e,t)=>{e=new mi(e,t);let r=new hi("0.0.0");if(e.test(r))return r;if(r=new hi("0.0.0-0"),e.test(r))return r;r=null;for(let t=0;t<e.set.length;++t){const n=e.set[t];let s=null;n.forEach(e=>{const t=new hi(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":s&&!yi(t,s)||(s=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}}),!s||r&&!yi(r,s)||(r=s)}return r&&e.test(r)?r:null};const gi=ri();var _i=(e,t)=>{try{return new gi(e,t).range||"*"}catch(e){return null}};const bi=Xn,Ei=ni(),{ANY:wi}=Ei,Si=ri(),Ti=ii,xi=Is,ki=Rs,Oi=Ds,Ii=Ls;var $i=(e,t,r,n)=>{let s,i,a,o,c;switch(e=new bi(e,n),t=new Si(t,n),r){case">":s=xi,i=Oi,a=ki,o=">",c=">=";break;case"<":s=ki,i=Ii,a=xi,o="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Ti(e,t,n))return!1;for(let r=0;r<t.set.length;++r){const u=t.set[r];let l=null,d=null;if(u.forEach(e=>{e.semver===wi&&(e=new Ei(">=0.0.0")),l=l||e,d=d||e,s(e.semver,l.semver,n)?l=e:a(e.semver,d.semver,n)&&(d=e)}),l.operator===o||l.operator===c)return!1;if((!d.operator||d.operator===o)&&i(e,d.semver))return!1;if(d.operator===c&&a(e,d.semver))return!1}return!0};const Ri=$i;var Ni=(e,t,r)=>Ri(e,t,">",r);const Ai=$i;var ji=(e,t,r)=>Ai(e,t,"<",r);const Pi=ri();var Ci=(e,t,r)=>(e=new Pi(e,r),t=new Pi(t,r),e.intersects(t,r));const Li=ii,Zi=ys;const Di=ri(),Mi=ni(),{ANY:Ui}=Mi,Fi=ii,Bi=ys,Vi=[new Mi(">=0.0.0-0")],Ki=[new Mi(">=0.0.0")],Gi=(e,t,r)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===Ui){if(1===t.length&&t[0].semver===Ui)return!0;e=r.includePrerelease?Vi:Ki}if(1===t.length&&t[0].semver===Ui){if(r.includePrerelease)return!0;t=Ki}const n=new Set;let s,i,a,o,c,u,l;for(const t of e)">"===t.operator||">="===t.operator?s=zi(s,t,r):"<"===t.operator||"<="===t.operator?i=qi(i,t,r):n.add(t.semver);if(n.size>1)return null;if(s&&i){if(a=Bi(s.semver,i.semver,r),a>0)return null;if(0===a&&(">="!==s.operator||"<="!==i.operator))return null}for(const e of n){if(s&&!Fi(e,String(s),r))return null;if(i&&!Fi(e,String(i),r))return null;for(const n of t)if(!Fi(e,String(n),r))return!1;return!0}let d=!(!i||r.includePrerelease||!i.semver.prerelease.length)&&i.semver,f=!(!s||r.includePrerelease||!s.semver.prerelease.length)&&s.semver;d&&1===d.prerelease.length&&"<"===i.operator&&0===d.prerelease[0]&&(d=!1);for(const e of t){if(l=l||">"===e.operator||">="===e.operator,u=u||"<"===e.operator||"<="===e.operator,s)if(f&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===f.major&&e.semver.minor===f.minor&&e.semver.patch===f.patch&&(f=!1),">"===e.operator||">="===e.operator){if(o=zi(s,e,r),o===e&&o!==s)return!1}else if(">="===s.operator&&!Fi(s.semver,String(e),r))return!1;if(i)if(d&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===d.major&&e.semver.minor===d.minor&&e.semver.patch===d.patch&&(d=!1),"<"===e.operator||"<="===e.operator){if(c=qi(i,e,r),c===e&&c!==i)return!1}else if("<="===i.operator&&!Fi(i.semver,String(e),r))return!1;if(!e.operator&&(i||s)&&0!==a)return!1}return!(s&&u&&!i&&0!==a)&&(!(i&&l&&!s&&0!==a)&&(!f&&!d))},zi=(e,t,r)=>{if(!e)return t;const n=Bi(e.semver,t.semver,r);return n>0?e:n<0||">"===t.operator&&">="===e.operator?t:e},qi=(e,t,r)=>{if(!e)return t;const n=Bi(e.semver,t.semver,r);return n<0?e:n>0||"<"===t.operator&&"<="===e.operator?t:e};var Hi=(e,t,r={})=>{if(e===t)return!0;e=new Di(e,r),t=new Di(t,r);let n=!1;e:for(const s of e.set){for(const e of t.set){const t=Gi(s,e,r);if(n=n||null!==t,t)continue e}if(n)return!1}return!0};const Wi=Ln,Xi=Pn,Ji=Xn,Yi=Bn,Qi=(e,t,r)=>{const n=[];let s=null,i=null;const a=e.sort((e,t)=>Zi(e,t,r));for(const e of a){Li(e,t,r)?(i=e,s||(s=e)):(i&&n.push([s,i]),i=null,s=null)}s&&n.push([s,null]);const o=[];for(const[e,t]of n)e===t?o.push(e):t||e!==a[0]?t?e===a[0]?o.push(`<=${t}`):o.push(`${e} - ${t}`):o.push(`>=${e}`):o.push("*");const c=o.join(" || "),u="string"==typeof t.raw?t.raw:String(t);return c.length<u.length?c:t};var ea={parse:Yn,valid:es,clean:rs,inc:ss,diff:as,major:cs,minor:ls,patch:fs,prerelease:hs,compare:ys,rcompare:gs,compareLoose:bs,compareBuild:ws,sort:Ts,rsort:ks,gt:Is,lt:Rs,eq:As,neq:Ps,gte:Ls,lte:Ds,cmp:Gs,coerce:Xs,Comparator:ni(),Range:ri(),satisfies:ii,toComparators:oi,maxSatisfying:li,minSatisfying:pi,minVersion:vi,validRange:_i,outside:$i,gtr:Ni,ltr:ji,intersects:Ci,simplifyRange:Qi,subset:Hi,SemVer:Ji,re:Wi.re,src:Wi.src,tokens:Wi.t,SEMVER_SPEC_VERSION:Xi.SEMVER_SPEC_VERSION,RELEASE_TYPES:Xi.RELEASE_TYPES,compareIdentifiers:Yi.compareIdentifiers,rcompareIdentifiers:Yi.rcompareIdentifiers};var ta=ea.satisfies(process.version,">=15.7.0");var ra=ea.satisfies(process.version,">=16.9.0");const na=ta,sa=ra,ia={ec:["ES256","ES384","ES512"],rsa:["RS256","PS256","RS384","PS384","RS512","PS512"],"rsa-pss":["PS256","PS384","PS512"]},aa={ES256:"prime256v1",ES384:"secp384r1",ES512:"secp521r1"};var oa=function(e,t){if(!e||!t)return;const r=t.asymmetricKeyType;if(!r)return;const n=ia[r];if(!n)throw new Error(`Unknown key type "${r}".`);if(!n.includes(e))throw new Error(`"alg" parameter for "${r}" key type must be one of: ${n.join(", ")}.`);if(na)switch(r){case"ec":const r=t.asymmetricKeyDetails.namedCurve,n=aa[e];if(r!==n)throw new Error(`"alg" parameter "${e}" requires curve "${n}".`);break;case"rsa-pss":if(sa){const r=parseInt(e.slice(-3),10),{hashAlgorithm:n,mgf1HashAlgorithm:s,saltLength:i}=t.asymmetricKeyDetails;if(n!==`sha${r}`||s!==n)throw new Error(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${e}.`);if(void 0!==i&&i>r>>3)throw new Error(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${e}.`)}}},ca=ea.satisfies(process.version,"^6.12.0 || >=8.0.0");const ua=Tn,la=On,da=Rn,fa=wn,pa=An,ha=oa,ma=ca,ya=nr,{KeyObject:va,createSecretKey:ga,createPublicKey:_a}=s,ba=["RS256","RS384","RS512"],Ea=["ES256","ES384","ES512"],wa=["RS256","RS384","RS512"],Sa=["HS256","HS384","HS512"];ma&&(ba.splice(ba.length,0,"PS256","PS384","PS512"),wa.splice(wa.length,0,"PS256","PS384","PS512"));var Ta=1/0,xa=9007199254740991,ka=17976931348623157e292,Oa=NaN,Ia="[object Arguments]",$a="[object Function]",Ra="[object GeneratorFunction]",Na="[object String]",Aa="[object Symbol]",ja=/^\s+|\s+$/g,Pa=/^[-+]0x[0-9a-f]+$/i,Ca=/^0b[01]+$/i,La=/^0o[0-7]+$/i,Za=/^(?:0|[1-9]\d*)$/,Da=parseInt;function Ma(e){return e!=e}function Ua(e,t){return function(e,t){for(var r=-1,n=e?e.length:0,s=Array(n);++r<n;)s[r]=t(e[r],r,e);return s}(t,function(t){return e[t]})}var Fa,Ba,Va=Object.prototype,Ka=Va.hasOwnProperty,Ga=Va.toString,za=Va.propertyIsEnumerable,qa=(Fa=Object.keys,Ba=Object,function(e){return Fa(Ba(e))}),Ha=Math.max;function Wa(e,t){var r=Ya(e)||function(e){return function(e){return to(e)&&Qa(e)}(e)&&Ka.call(e,"callee")&&(!za.call(e,"callee")||Ga.call(e)==Ia)}(e)?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],n=r.length,s=!!n;for(var i in e)!t&&!Ka.call(e,i)||s&&("length"==i||Ja(i,n))||r.push(i);return r}function Xa(e){if(r=(t=e)&&t.constructor,n="function"==typeof r&&r.prototype||Va,t!==n)return qa(e);var t,r,n,s=[];for(var i in Object(e))Ka.call(e,i)&&"constructor"!=i&&s.push(i);return s}function Ja(e,t){return!!(t=null==t?xa:t)&&("number"==typeof e||Za.test(e))&&e>-1&&e%1==0&&e<t}var Ya=Array.isArray;function Qa(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=xa}(e.length)&&!function(e){var t=eo(e)?Ga.call(e):"";return t==$a||t==Ra}(e)}function eo(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function to(e){return!!e&&"object"==typeof e}var ro=function(e,t,r,n){var s;e=Qa(e)?e:(s=e)?Ua(s,function(e){return Qa(e)?Wa(e):Xa(e)}(s)):[],r=r&&!n?function(e){var t=function(e){if(!e)return 0===e?e:0;if(e=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||to(e)&&Ga.call(e)==Aa}(e))return Oa;if(eo(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=eo(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(ja,"");var r=Ca.test(e);return r||La.test(e)?Da(e.slice(2),r?2:8):Pa.test(e)?Oa:+e}(e),e===Ta||e===-1/0){return(e<0?-1:1)*ka}return e==e?e:0}(e),r=t%1;return t==t?r?t-r:t:0}(r):0;var i=e.length;return r<0&&(r=Ha(i+r,0)),function(e){return"string"==typeof e||!Ya(e)&&to(e)&&Ga.call(e)==Na}(e)?r<=i&&e.indexOf(t,r)>-1:!!i&&function(e,t,r){if(t!=t)return function(e,t,r,n){for(var s=e.length,i=r+(n?1:-1);n?i--:++i<s;)if(t(e[i],i,e))return i;return-1}(e,Ma,r);for(var n=r-1,s=e.length;++n<s;)if(e[n]===t)return n;return-1}(e,t,r)>-1},no=Object.prototype.toString;var so=function(e){return!0===e||!1===e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Boolean]"==no.call(e)},io=1/0,ao=17976931348623157e292,oo=NaN,co="[object Symbol]",uo=/^\s+|\s+$/g,lo=/^[-+]0x[0-9a-f]+$/i,fo=/^0b[01]+$/i,po=/^0o[0-7]+$/i,ho=parseInt,mo=Object.prototype.toString;function yo(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var vo=function(e){return"number"==typeof e&&e==function(e){var t=function(e){if(!e)return 0===e?e:0;if(e=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&mo.call(e)==co}(e))return oo;if(yo(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=yo(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(uo,"");var r=fo.test(e);return r||po.test(e)?ho(e.slice(2),r?2:8):lo.test(e)?oo:+e}(e),e===io||e===-1/0){return(e<0?-1:1)*ao}return e==e?e:0}(e),r=t%1;return t==t?r?t-r:t:0}(e)},go=Object.prototype.toString;var _o=function(e){return"number"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Number]"==go.call(e)};var bo=Function.prototype,Eo=Object.prototype,wo=bo.toString,So=Eo.hasOwnProperty,To=wo.call(Object),xo=Eo.toString,ko=function(e,t){return function(r){return e(t(r))}}(Object.getPrototypeOf,Object);var Oo=function(e){if(!function(e){return!!e&&"object"==typeof e}(e)||"[object Object]"!=xo.call(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e))return!1;var t=ko(e);if(null===t)return!0;var r=So.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&wo.call(r)==To},Io=Object.prototype.toString,$o=Array.isArray;var Ro=function(e){return"string"==typeof e||!$o(e)&&function(e){return!!e&&"object"==typeof e}(e)&&"[object String]"==Io.call(e)},No=1/0,Ao=17976931348623157e292,jo=NaN,Po="[object Symbol]",Co=/^\s+|\s+$/g,Lo=/^[-+]0x[0-9a-f]+$/i,Zo=/^0b[01]+$/i,Do=/^0o[0-7]+$/i,Mo=parseInt,Uo=Object.prototype.toString;function Fo(e,t){var r;if("function"!=typeof t)throw new TypeError("Expected a function");return e=function(e){var t=function(e){if(!e)return 0===e?e:0;if(e=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&Uo.call(e)==Po}(e))return jo;if(Bo(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Bo(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(Co,"");var r=Zo.test(e);return r||Do.test(e)?Mo(e.slice(2),r?2:8):Lo.test(e)?jo:+e}(e),e===No||e===-1/0){return(e<0?-1:1)*Ao}return e==e?e:0}(e),r=t%1;return t==t?r?t-r:t:0}(e),function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=void 0),r}}function Bo(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var Vo=function(e){return Fo(2,e)};const Ko=An,Go=ca,zo=oa,qo=nr,Ho=ro,Wo=so,Xo=vo,Jo=_o,Yo=Oo,Qo=Ro,ec=Vo,{KeyObject:tc,createSecretKey:rc,createPrivateKey:nc}=s,sc=["RS256","RS384","RS512","ES256","ES384","ES512","HS256","HS384","HS512","none"];Go&&sc.splice(3,0,"PS256","PS384","PS512");const ic={expiresIn:{isValid:function(e){return Xo(e)||Qo(e)&&e},message:'"expiresIn" should be a number of seconds or string representing a timespan'},notBefore:{isValid:function(e){return Xo(e)||Qo(e)&&e},message:'"notBefore" should be a number of seconds or string representing a timespan'},audience:{isValid:function(e){return Qo(e)||Array.isArray(e)},message:'"audience" must be a string or array'},algorithm:{isValid:Ho.bind(null,sc),message:'"algorithm" must be a valid string enum value'},header:{isValid:Yo,message:'"header" must be an object'},encoding:{isValid:Qo,message:'"encoding" must be a string'},issuer:{isValid:Qo,message:'"issuer" must be a string'},subject:{isValid:Qo,message:'"subject" must be a string'},jwtid:{isValid:Qo,message:'"jwtid" must be a string'},noTimestamp:{isValid:Wo,message:'"noTimestamp" must be a boolean'},keyid:{isValid:Qo,message:'"keyid" must be a string'},mutatePayload:{isValid:Wo,message:'"mutatePayload" must be a boolean'},allowInsecureKeySizes:{isValid:Wo,message:'"allowInsecureKeySizes" must be a boolean'},allowInvalidAsymmetricKeyTypes:{isValid:Wo,message:'"allowInvalidAsymmetricKeyTypes" must be a boolean'}},ac={iat:{isValid:Jo,message:'"iat" should be a number of seconds'},exp:{isValid:Jo,message:'"exp" should be a number of seconds'},nbf:{isValid:Jo,message:'"nbf" should be a number of seconds'}};function oc(e,t,r,n){if(!Yo(r))throw new Error('Expected "'+n+'" to be a plain object.');Object.keys(r).forEach(function(s){const i=e[s];if(i){if(!i.isValid(r[s]))throw new Error(i.message)}else if(!t)throw new Error('"'+s+'" is not allowed in "'+n+'"')})}const cc={audience:"aud",issuer:"iss",subject:"sub",jwtid:"jti"},uc=["expiresIn","notBefore","noTimestamp","audience","issuer","subject","jwtid"];var lc={decode:wn,verify:function(e,t,r,n){let s;if("function"!=typeof r||n||(n=r,r={}),r||(r={}),r=Object.assign({},r),s=n||function(e,t){if(e)throw e;return t},r.clockTimestamp&&"number"!=typeof r.clockTimestamp)return s(new ua("clockTimestamp must be a number"));if(void 0!==r.nonce&&("string"!=typeof r.nonce||""===r.nonce.trim()))return s(new ua("nonce must be a non-empty string"));if(void 0!==r.allowInvalidAsymmetricKeyTypes&&"boolean"!=typeof r.allowInvalidAsymmetricKeyTypes)return s(new ua("allowInvalidAsymmetricKeyTypes must be a boolean"));const i=r.clockTimestamp||Math.floor(Date.now()/1e3);if(!e)return s(new ua("jwt must be provided"));if("string"!=typeof e)return s(new ua("jwt must be a string"));const a=e.split(".");if(3!==a.length)return s(new ua("jwt malformed"));let o;try{o=fa(e,{complete:!0})}catch(e){return s(e)}if(!o)return s(new ua("invalid token"));const c=o.header;let u;if("function"==typeof t){if(!n)return s(new ua("verify must be called asynchronous if secret or public key is provided as a callback"));u=t}else u=function(e,r){return r(null,t)};return u(c,function(t,n){if(t)return s(new ua("error in secret or public key callback: "+t.message));const u=""!==a[2].trim();if(!u&&n)return s(new ua("jwt signature is required"));if(u&&!n)return s(new ua("secret or public key must be provided"));if(!u&&!r.algorithms)return s(new ua('please specify "none" in "algorithms" to verify unsigned tokens'));if(null!=n&&!(n instanceof va))try{n=_a(n)}catch(e){try{n=ga("string"==typeof n?Buffer.from(n):n)}catch(e){return s(new ua("secretOrPublicKey is not valid key material"))}}if(r.algorithms||("secret"===n.type?r.algorithms=Sa:["rsa","rsa-pss"].includes(n.asymmetricKeyType)?r.algorithms=wa:"ec"===n.asymmetricKeyType?r.algorithms=Ea:r.algorithms=ba),-1===r.algorithms.indexOf(o.header.alg))return s(new ua("invalid algorithm"));if(c.alg.startsWith("HS")&&"secret"!==n.type)return s(new ua(`secretOrPublicKey must be a symmetric key when using ${c.alg}`));if(/^(?:RS|PS|ES)/.test(c.alg)&&"public"!==n.type)return s(new ua(`secretOrPublicKey must be an asymmetric key when using ${c.alg}`));if(!r.allowInvalidAsymmetricKeyTypes)try{ha(c.alg,n)}catch(e){return s(e)}let l;try{l=ya.verify(e,o.header.alg,n)}catch(e){return s(e)}if(!l)return s(new ua("invalid signature"));const d=o.payload;if(void 0!==d.nbf&&!r.ignoreNotBefore){if("number"!=typeof d.nbf)return s(new ua("invalid nbf value"));if(d.nbf>i+(r.clockTolerance||0))return s(new la("jwt not active",new Date(1e3*d.nbf)))}if(void 0!==d.exp&&!r.ignoreExpiration){if("number"!=typeof d.exp)return s(new ua("invalid exp value"));if(i>=d.exp+(r.clockTolerance||0))return s(new da("jwt expired",new Date(1e3*d.exp)))}if(r.audience){const e=Array.isArray(r.audience)?r.audience:[r.audience];if(!(Array.isArray(d.aud)?d.aud:[d.aud]).some(function(t){return e.some(function(e){return e instanceof RegExp?e.test(t):e===t})}))return s(new ua("jwt audience invalid. expected: "+e.join(" or ")))}if(r.issuer){if("string"==typeof r.issuer&&d.iss!==r.issuer||Array.isArray(r.issuer)&&-1===r.issuer.indexOf(d.iss))return s(new ua("jwt issuer invalid. expected: "+r.issuer))}if(r.subject&&d.sub!==r.subject)return s(new ua("jwt subject invalid. expected: "+r.subject));if(r.jwtid&&d.jti!==r.jwtid)return s(new ua("jwt jwtid invalid. expected: "+r.jwtid));if(r.nonce&&d.nonce!==r.nonce)return s(new ua("jwt nonce invalid. expected: "+r.nonce));if(r.maxAge){if("number"!=typeof d.iat)return s(new ua("iat required when maxAge is specified"));const e=pa(r.maxAge,d.iat);if(void 0===e)return s(new ua('"maxAge" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));if(i>=e+(r.clockTolerance||0))return s(new da("maxAge exceeded",new Date(1e3*e)))}if(!0===r.complete){const e=o.signature;return s(null,{header:c,payload:d,signature:e})}return s(null,d)})},sign:function(e,t,r,n){"function"==typeof r?(n=r,r={}):r=r||{};const s="object"==typeof e&&!Buffer.isBuffer(e),i=Object.assign({alg:r.algorithm||"HS256",typ:s?"JWT":void 0,kid:r.keyid},r.header);function a(e){if(n)return n(e);throw e}if(!t&&"none"!==r.algorithm)return a(new Error("secretOrPrivateKey must have a value"));if(null!=t&&!(t instanceof tc))try{t=nc(t)}catch(e){try{t=rc("string"==typeof t?Buffer.from(t):t)}catch(e){return a(new Error("secretOrPrivateKey is not valid key material"))}}if(i.alg.startsWith("HS")&&"secret"!==t.type)return a(new Error(`secretOrPrivateKey must be a symmetric key when using ${i.alg}`));if(/^(?:RS|PS|ES)/.test(i.alg)){if("private"!==t.type)return a(new Error(`secretOrPrivateKey must be an asymmetric key when using ${i.alg}`));if(!r.allowInsecureKeySizes&&!i.alg.startsWith("ES")&&void 0!==t.asymmetricKeyDetails&&t.asymmetricKeyDetails.modulusLength<2048)return a(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`))}if(void 0===e)return a(new Error("payload is required"));if(s){try{!function(e){oc(ac,!0,e,"payload")}(e)}catch(e){return a(e)}r.mutatePayload||(e=Object.assign({},e))}else{const t=uc.filter(function(e){return void 0!==r[e]});if(t.length>0)return a(new Error("invalid "+t.join(",")+" option for "+typeof e+" payload"))}if(void 0!==e.exp&&void 0!==r.expiresIn)return a(new Error('Bad "options.expiresIn" option the payload already has an "exp" property.'));if(void 0!==e.nbf&&void 0!==r.notBefore)return a(new Error('Bad "options.notBefore" option the payload already has an "nbf" property.'));try{!function(e){oc(ic,!1,e,"options")}(r)}catch(e){return a(e)}if(!r.allowInvalidAsymmetricKeyTypes)try{zo(i.alg,t)}catch(e){return a(e)}const o=e.iat||Math.floor(Date.now()/1e3);if(r.noTimestamp?delete e.iat:s&&(e.iat=o),void 0!==r.notBefore){try{e.nbf=Ko(r.notBefore,o)}catch(e){return a(e)}if(void 0===e.nbf)return a(new Error('"notBefore" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}if(void 0!==r.expiresIn&&"object"==typeof e){try{e.exp=Ko(r.expiresIn,o)}catch(e){return a(e)}if(void 0===e.exp)return a(new Error('"expiresIn" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}Object.keys(cc).forEach(function(t){const n=cc[t];if(void 0!==r[t]){if(void 0!==e[n])return a(new Error('Bad "options.'+t+'" option. The payload already has an "'+n+'" property.'));e[n]=r[t]}});const c=r.encoding||"utf8";if("function"!=typeof n){let n=qo.sign({header:i,payload:e,secret:t,encoding:c});if(!r.allowInsecureKeySizes&&/^(?:RS|PS)/.test(i.alg)&&n.length<256)throw new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`);return n}n=n&&ec(n),qo.createSign({header:i,privateKey:t,payload:e,encoding:c}).once("error",n).once("done",function(e){if(!r.allowInsecureKeySizes&&/^(?:RS|PS)/.test(i.alg)&&e.length<256)return n(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`));n(null,e)})},JsonWebTokenError:Tn,NotBeforeError:On,TokenExpiredError:Rn},dc=d(lc),fc=i({__proto__:null,default:dc},[lc]);var pc=(e,t)=>{const{database:r,services:n,getSchema:s,env:i}=t;e.post("/request",async(e,t)=>{await async function(e,t,{database:r,services:n,getSchema:s,env:i}){try{const{phone:n}=e.body;if(console.log("phone",n),!n)return void t.status(400).json({success:!1,error:"Le numro de tlphone est requis"});const s=n.trim().replace(/\s+/g,"");if(!/^\+?[1-9]\d{1,14}$/.test(s))return void t.status(400).json({success:!1,error:"Format de numro de tlphone invalide. Utilisez le format international (+33...)"});const i=await r("directus_users").where({phone:s}).first();if(console.log("user",JSON.stringify(i,null,2)),!i)return void t.status(404).json({success:!1,error:"Aucun utilisateur trouv avec ce numro de tlphone"});if("active"!==i.status)return void t.status(403).json({success:!1,error:"Le compte utilisateur n'est pas actif"});const a=await r("directus_roles").where({id:i.role}).first();if(!a||"App User"!==a.name)return void t.status(403).json({success:!1,error:"Accs refus. Seuls les utilisateurs avec le rle 'App User' peuvent utiliser cette fonctionnalit"});const o=new tr(r),c=new rr;await o.invalidateAllForPhone(s);const u=er.generateCode(),l=await er.hashCode(u),d=er.getExpirationDate(5);if(await o.create({user_id:i.id,code:l,phone:s,expires_at:d,attempts:0,used:!1,ip_address:e.ip,user_agent:e.headers["user-agent"]}),!await c.sendOTP(s,u))return void t.status(500).json({success:!1,error:"Erreur lors de l'envoi du SMS. Veuillez ressayer."});t.status(200).json({success:!0,message:`Code OTP envoy par SMS au ${s}`})}catch(e){console.error("Erreur dans requestOTP:",e),t.status(500).json({success:!1,error:"Erreur interne du serveur"})}}(e,t,{database:r,services:n,getSchema:s,env:i})}),e.post("/verify",async(e,t)=>{await async function(e,t,{database:r,services:n,getSchema:s,env:i}){try{const{phone:a,code:o}=e.body;if(!a||!o)return void t.status(400).json({success:!1,error:"Le numro de tlphone et le code sont requis"});const c=a.trim().replace(/\s+/g,""),l=o.trim();if(!/^\d{6}$/.test(l))return void t.status(400).json({success:!1,error:"Le code doit contenir 6 chiffres"});const d=new tr(r),f=await d.getLatestByPhone(c);if(!f)return void t.status(404).json({success:!1,error:"Aucun code OTP trouv. Veuillez en demander un nouveau."});if(er.isExpired(f.expires_at))return void t.status(400).json({success:!1,error:"Le code OTP a expir. Veuillez en demander un nouveau."});if(f.attempts>=3)return void t.status(429).json({success:!1,error:"Trop de tentatives. Veuillez demander un nouveau code."});if(!await er.verifyCode(l,f.code)){const e=3-await d.incrementAttempts(f.id);return void t.status(401).json({success:!1,error:e>0?`Code invalide. ${e} tentative(s) restante(s).`:"Code invalide. Trop de tentatives. Veuillez demander un nouveau code."})}await d.markAsUsed(f.id);const p=await r("directus_users").where({id:f.user_id}).first();if(!p)return void t.status(404).json({success:!1,error:"Utilisateur introuvable"});if("active"!==p.status)return void t.status(403).json({success:!1,error:"Le compte utilisateur n'est pas actif"});if(!await r("directus_roles").where({id:p.role}).first())return void t.status(500).json({success:!1,error:"Erreur lors de la rcupration du rle"});const h=await s(),{AuthenticationService:m}=n,y=new m({knex:r,schema:h,accountability:null}),{nanoid:v}=await Promise.resolve().then(function(){return u}),g=(e,t)=>{if("number"==typeof e)return e;if("string"==typeof e){const r=e.match(/^(\d+)([smhd])$/);if(r)return parseInt(r[1])*({s:1e3,m:6e4,h:36e5,d:864e5}[r[2]]||t)}return t},_=v(64),b=new Date(Date.now()+g(i.REFRESH_TOKEN_TTL,6048e5));await r("directus_sessions").insert({token:_,user:p.id,ip:e.ip||null,user_agent:e.headers["user-agent"]||null,origin:e.headers.origin||e.headers.referer||null,expires:b});try{const e=await y.refresh(_,{session:!0});await d.cleanupExpired(),t.status(200).json({success:!0,message:"Authentification russie",access_token:e.accessToken,refresh_token:e.refreshToken,expires:e.expires||9e5})}catch(e){console.error("Erreur lors du refresh:",e),console.error("Dtails de l'erreur:",e.message);const n=await r("directus_roles").where({id:p.role}).first(),s=!1!==n?.app_access,a=!0===n?.admin_access,o={id:p.id,role:p.role,app_access:s,admin_access:a,session:_},c=i.SESSION_COOKIE_TTL||i.ACCESS_TOKEN_TTL||"15m",u=await Promise.resolve().then(function(){return fc}),l=i.SECRET||process.env.SECRET||"directus_secret_to_sign_access_tokens",f=u.sign(o,l,{expiresIn:c,issuer:"directus"});await r("directus_users").update({last_access:new Date}).where({id:p.id}),await d.cleanupExpired(),t.status(200).json({success:!0,message:"Authentification russie",access_token:f,refresh_token:_,expires:g(c,9e5)})}}catch(e){console.error("Erreur dans verifyOTP:",e),t.status(500).json({success:!1,error:"Erreur interne du serveur"})}}(e,t,{database:r,services:n,getSchema:s,env:i})}),e.get("/me",async(e,t)=>{await async function(e,t,{database:r,services:n,getSchema:s,env:i}){try{const n=e.headers.authorization;if(!n||!n.startsWith("Bearer "))return void t.status(401).json({success:!1,error:"Token d'authentification manquant"});const s=n.substring(7),a=i.SECRET||process.env.SECRET||"directus_secret_to_sign_access_tokens";let o;try{o=dc.verify(s,a)}catch(e){return void t.status(401).json({success:!1,error:"Token invalide ou expir"})}const c=await r("directus_users").where({id:o.id}).first();if(!c)return void t.status(404).json({success:!1,error:"Utilisateur introuvable"});const{password:u,...l}=c;t.status(200).json({success:!0,data:l})}catch(e){console.error("Erreur dans getMe:",e),t.status(500).json({success:!1,error:"Erreur interne du serveur"})}}(e,t,{database:r,services:n,getSchema:s,env:i})}),e.get("/users",async(e,t)=>{await async function(e,t,{database:r,services:n,getSchema:s,env:i}){try{const n=e.headers.authorization;if(!n||!n.startsWith("Bearer "))return void t.status(401).json({success:!1,error:"Token d'authentification manquant"});const s=n.substring(7),a=i.SECRET||process.env.SECRET||"directus_secret_to_sign_access_tokens";let o;try{o=dc.verify(s,a)}catch(e){return void t.status(401).json({success:!1,error:"Token invalide ou expir"})}const c=await r("directus_users").where({id:o.id}).first();if(!c)return void t.status(404).json({success:!1,error:"Utilisateur introuvable"});if("active"!==c.status)return void t.status(403).json({success:!1,error:"Le compte utilisateur n'est pas actif"});const u=(await r("directus_users").select("id","first_name","last_name","email","phone","status","role","created_on","last_access").orderBy("created_on","desc")).map(e=>{const{password:t,...r}=e;return r});t.status(200).json({success:!0,data:u})}catch(e){console.error("Erreur dans getUsers:",e),t.status(500).json({success:!1,error:"Erreur interne du serveur"})}}(e,t,{database:r,services:n,getSchema:s,env:i})}),e.get("/health",(e,t)=>{t.json({status:"ok",extension:"directus-extension-otp-auth",version:"1.0.0",endpoints:["POST /otp/request","POST /otp/verify","GET /otp/me","GET /otp/health"]})})};module.exports=pc;
